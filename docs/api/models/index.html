
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Models API Documentation &#8212; MineStudio</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=d6734ac8" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=00f267c6"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/thebelab-helper.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/models/index';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://craftjarvis.github.io/MineStudio/_static/version.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'latest';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>
    <script defer="defer" src="../../_static/custom-icons.js?v=26a3f3bc"></script>
    <link rel="icon" href="../../_static/logo-no-text-light.svg"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Offline API Documentation" href="../offline/index.html" />
    <link rel="prev" title="Data API Documentation" href="../data/index.html" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />   
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo-no-text-light.svg" class="logo__image only-light" alt=""/>
    <img src="../../_static/logo-no-text-light.svg" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">MineStudio</p>
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../overview/index.html">
    Overview
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../overview/getting-started.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../simulator/index.html">
    Simulator
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../data/index.html">
    Data
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../models/index.html">
    Models
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../offline/index.html">
    Offline
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../online/index.html">
    Online
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../inference/index.html">
    Inference
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../benchmark/index.html">
    Benchmark
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../index.html">
    API
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/CraftJarvis/MineStudio" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/minestudio" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-pypi fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://arxiv.org/pdf/2411.18293" title="ArXiv" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-arxiv fa-lg" aria-hidden="true"></i>
            <span class="sr-only">ArXiv</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
          
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../overview/index.html">
    Overview
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../overview/getting-started.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../simulator/index.html">
    Simulator
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../data/index.html">
    Data
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../models/index.html">
    Models
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../offline/index.html">
    Offline
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../online/index.html">
    Online
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../inference/index.html">
    Inference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../benchmark/index.html">
    Benchmark
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../index.html">
    API
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/CraftJarvis/MineStudio" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/minestudio" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-pypi fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://arxiv.org/pdf/2411.18293" title="ArXiv" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-arxiv fa-lg" aria-hidden="true"></i>
            <span class="sr-only">ArXiv</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../overview/installation.html">Installation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MineStudio Libraries</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../simulator/index.html">Simulator</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../simulator/general-information.html">General Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../simulator/design-principles.html">Design Principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../simulator/play.html">Graphical User Interfaces</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../data/index.html">Data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../data/dataset-raw.html">Raw Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/dataset-event.html">Event Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/visualization.html">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/convertion.html">Data Conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/callbacks.html">Data Processing Callbacks</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../models/index.html">Models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../models/baseline-vpt.html">Built-in Models: VPT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/baseline-steve1.html">Built-in Models: STEVE-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/baseline-groot.html">Built-in Models: GROOT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/baseline-rocket1.html">Built-in Models: ROCKET-1</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../offline/index.html">Offline Training</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../offline/tutorial-vpt.html">Tutorial: Fine-tuning VPT to a Hunter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../offline/tutorial-rocket.html">Tutorial: Pre-Training ROCKET-1 from Scratch</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../online/index.html">Online Training</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../online/general-information.html">Online Training Module: General Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../online/config.html">Configuring Online Training Sessions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../online/trainer.html">Trainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../online/rollout.html">Rollout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../online/run.html">Launching Online Training: The <code class="docutils literal notranslate"><span class="pre">run.py</span></code> Script</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../online/utils.html">Shared Utilities for Online Training: The <code class="docutils literal notranslate"><span class="pre">utils</span></code> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../online/customization.html">Customize</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../inference/index.html">Inference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../inference/baseline-vpt.html">Tutorial: Inference with VPT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../inference/baseline-groot.html">Tutorial: Inference with GROOT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../inference/baseline-steve1.html">Tutorial: Inference with STEVE-1</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../benchmark/index.html">Benchmark</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../benchmark/quick-benchmark.html">Quick benchmark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../benchmark/automatic-evaluation.html">Automatic Evaluation Pipeline</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">MineStudio API Documentation</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../simulator/index.html">Simulator</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../data/index.html">Data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="current reference internal" href="#">Models</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../offline/index.html">Offline</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../online/index.html">Online</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../inference/index.html">Inference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../overview/index.html" class="nav-link">Overview</a></li>
    
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">MineStudio API Documentation</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Models API Documentation</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                   <section id="models-api-documentation">
<h1>Models API Documentation<a class="headerlink" href="#models-api-documentation" title="Link to this heading">#</a></h1>
<div class="toctree-wrapper compound">
</div>
<section id="module-minestudio.models.base_policy">
<span id="basepolicy"></span><h2>BasePolicy<a class="headerlink" href="#module-minestudio.models.base_policy" title="Link to this heading">#</a></h2>
<p>Date: 2024-11-11 15:59:37
LastEditors: muzhancun <a class="reference external" href="mailto:muzhancun&#37;&#52;&#48;stu&#46;pku&#46;edu&#46;cn">muzhancun<span>&#64;</span>stu<span>&#46;</span>pku<span>&#46;</span>edu<span>&#46;</span>cn</a>
LastEditTime: 2025-05-26 21:41:12
FilePath: /MineStudio/minestudio/models/base_policy.py</p>
<dl class="py class">
<dt class="sig sig-object py" id="minestudio.models.base_policy.MinePolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.models.base_policy.</span></span><span class="sig-name descname"><span class="pre">MinePolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hiddim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nucleus_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/base_policy.html#MinePolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.base_policy.MinePolicy" title="Link to this definition">#</a></dt>
<dd><p>Abstract base class for Minecraft policies.</p>
<p>This class defines the basic interface for a policy, including methods for
getting actions, computing initial states, and resetting parameters. It also
handles batching and unbatching of inputs and states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hiddim</strong> – The hidden dimension size.</p></li>
<li><p><strong>action_space</strong> – The action space of the environment. Defaults to a predefined
Dict space for “camera” and “buttons” if None.</p></li>
<li><p><strong>temperature</strong> – Temperature parameter for sampling actions from the policy head.
Defaults to 1.0.</p></li>
<li><p><strong>nucleus_prob</strong> – Nucleus probability for sampling actions. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="minestudio.models.base_policy.MinePolicy.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">device</span></em><a class="headerlink" href="#minestudio.models.base_policy.MinePolicy.device" title="Link to this definition">#</a></dt>
<dd><p>Gets the device of the policy’s parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The device (e.g., ‘cpu’, ‘cuda’).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.device</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.base_policy.MinePolicy.forward">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/minestudio/models/base_policy.html#MinePolicy.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.base_policy.MinePolicy.forward" title="Link to this definition">#</a></dt>
<dd><p>Abstract method for the forward pass of the policy.</p>
<p>Subclasses must implement this method to define the policy’s computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – A dictionary of input tensors.</p></li>
<li><p><strong>state_in</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>torch.Tensor</em><em>]</em><em>]</em>) – An optional list of input state tensors.</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing:
- latents (Dict[str, torch.Tensor]): A dictionary containing <cite>pi_logits</cite> and <cite>vpred</cite> latent tensors.
- state_out (List[torch.Tensor]): A list containing the updated state tensors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[Dict[str, torch.Tensor], List[torch.Tensor]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.base_policy.MinePolicy.get_action">
<span class="sig-name descname"><span class="pre">get_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'BT*'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/minestudio/models/base_policy.html#MinePolicy.get_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.base_policy.MinePolicy.get_action" title="Link to this definition">#</a></dt>
<dd><p>Gets an action from the policy.</p>
<p>This method performs a forward pass, samples an action, and handles
different input shapes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – A dictionary of input tensors.</p></li>
<li><p><strong>state_in</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>torch.Tensor</em><em>]</em><em>]</em>) – An optional list of input state tensors.</p></li>
<li><p><strong>deterministic</strong> (<em>bool</em>) – Whether to sample actions deterministically. Defaults to False.</p></li>
<li><p><strong>input_shape</strong> (<em>str</em>) – The shape of the input. Can be “*” (single instance) or “BT*”
(batched sequence). Defaults to “BT*”.</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing:
- action (Dict[str, torch.Tensor]): The sampled action.
- state_out (List[torch.Tensor]): The updated state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[Dict[str, torch.Tensor], List[torch.Tensor]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – if <cite>input_shape</cite> is not “*” or “BT*”.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.base_policy.MinePolicy.initial_state">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initial_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/minestudio/models/base_policy.html#MinePolicy.initial_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.base_policy.MinePolicy.initial_state" title="Link to this definition">#</a></dt>
<dd><p>Abstract method to get the initial state of the policy.</p>
<p>Subclasses must implement this method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch_size</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – The batch size for the initial state. Defaults to None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of initial state tensors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.base_policy.MinePolicy.merge_input">
<span class="sig-name descname"><span class="pre">merge_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tensor</span></span></span><a class="reference internal" href="../../_modules/minestudio/models/base_policy.html#MinePolicy.merge_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.base_policy.MinePolicy.merge_input" title="Link to this definition">#</a></dt>
<dd><p>Abstract method to merge multiple inputs.</p>
<p>Subclasses should implement this if they support merging inputs for, e.g.,
batched inference across multiple environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong> – The inputs to merge.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The merged input tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – if not implemented by the subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.base_policy.MinePolicy.merge_state">
<span class="sig-name descname"><span class="pre">merge_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">states</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/minestudio/models/base_policy.html#MinePolicy.merge_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.base_policy.MinePolicy.merge_state" title="Link to this definition">#</a></dt>
<dd><p>Abstract method to merge multiple states.</p>
<p>Subclasses should implement this if they support merging states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>states</strong> – The states to merge.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The merged state as an optional list of tensors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[List[torch.Tensor]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – if not implemented by the subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.base_policy.MinePolicy.reset_parameters">
<span class="sig-name descname"><span class="pre">reset_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/base_policy.html#MinePolicy.reset_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.base_policy.MinePolicy.reset_parameters" title="Link to this definition">#</a></dt>
<dd><p>Resets the parameters of the policy and value heads.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.base_policy.MinePolicy.split_action">
<span class="sig-name descname"><span class="pre">split_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_num</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/minestudio/models/base_policy.html#MinePolicy.split_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.base_policy.MinePolicy.split_action" title="Link to this definition">#</a></dt>
<dd><p>Splits a batched action into a list of individual actions.</p>
<p>Handles actions as dictionaries of tensors, single tensors, or lists.
Converts tensors to numpy arrays on CPU.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>action</strong> – The batched action to split.</p></li>
<li><p><strong>split_num</strong> – The number of individual actions in the batch.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of individual actions, or the original action list if already a list.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[List[Dict[str, torch.Tensor]]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – if the action type is not supported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.base_policy.MinePolicy.split_state">
<span class="sig-name descname"><span class="pre">split_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_num</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/minestudio/models/base_policy.html#MinePolicy.split_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.base_policy.MinePolicy.split_state" title="Link to this definition">#</a></dt>
<dd><p>Abstract method to split a state into multiple states.</p>
<p>Subclasses should implement this if they support splitting states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – The state to split.</p></li>
<li><p><strong>split_num</strong> – The number of ways to split the state.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An optional list of split states.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[List[List[torch.Tensor]]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – if not implemented by the subclass.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="minestudio.models.base_policy.dict_map">
<span class="sig-prename descclassname"><span class="pre">minestudio.models.base_policy.</span></span><span class="sig-name descname"><span class="pre">dict_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/base_policy.html#dict_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.base_policy.dict_map" title="Link to this definition">#</a></dt>
<dd><p>Recursively apply a function to all values in a dictionary or DictConfig.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fn</strong> – The function to apply.</p></li>
<li><p><strong>d</strong> – The dictionary or DictConfig.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new dictionary with the function applied to its values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="minestudio.models.base_policy.recursive_tensor_op">
<span class="sig-prename descclassname"><span class="pre">minestudio.models.base_policy.</span></span><span class="sig-name descname"><span class="pre">recursive_tensor_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">T</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">T</span></span></span><a class="reference internal" href="../../_modules/minestudio/models/base_policy.html#recursive_tensor_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.base_policy.recursive_tensor_op" title="Link to this definition">#</a></dt>
<dd><p>Recursively apply a function to all tensors in a nested structure of lists, tuples, or dictionaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fn</strong> – The function to apply to tensors.</p></li>
<li><p><strong>d</strong> (<em>TypeVar</em><em>(</em><em>&quot;T&quot;</em><em>)</em>) – The nested structure containing tensors.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new nested structure with the function applied to its tensors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>TypeVar</em>(“T”)</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if an unexpected type is encountered.</p>
</dd>
</dl>
</dd></dl>

<section id="module-minestudio.utils.vpt_lib.action_head">
<span id="action-head"></span><h3>Action Head<a class="headerlink" href="#module-minestudio.utils.vpt_lib.action_head" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.ActionHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.utils.vpt_lib.action_head.</span></span><span class="sig-name descname"><span class="pre">ActionHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#ActionHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.ActionHead" title="Link to this definition">#</a></dt>
<dd><p>Abstract base class for action heads.
Action heads are responsible for converting network outputs into action probability distributions
and providing methods for sampling, calculating log probabilities, entropy, and KL divergence.</p>
<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.ActionHead.entropy">
<span class="sig-name descname"><span class="pre">entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pd_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#ActionHead.entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.ActionHead.entropy" title="Link to this definition">#</a></dt>
<dd><p>Calculates the entropy of the probability distribution described by <cite>pd_params</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pd_params</strong> (<em>Any</em>) – Parameters describing the probability distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The entropy of the distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – This method must be implemented by subclasses.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.ActionHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#ActionHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.ActionHead.forward" title="Link to this definition">#</a></dt>
<dd><p>Performs a forward pass through the action head.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_data</strong> (<em>torch.Tensor</em>) – The input tensor from the policy network.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Parameters describing the probability distribution of actions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – This method must be implemented by subclasses.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.ActionHead.kl_divergence">
<span class="sig-name descname"><span class="pre">kl_divergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params_q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#ActionHead.kl_divergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.ActionHead.kl_divergence" title="Link to this definition">#</a></dt>
<dd><p>Calculates the KL divergence between two distributions described by <cite>params_q</cite> and <cite>params_p</cite>.
KL(Q || P).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params_q</strong> (<em>Any</em>) – Parameters of the first distribution (Q).</p></li>
<li><p><strong>params_p</strong> (<em>Any</em>) – Parameters of the second distribution (P).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The KL divergence between the two distributions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – This method must be implemented by subclasses.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.ActionHead.logprob">
<span class="sig-name descname"><span class="pre">logprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pd_params</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#ActionHead.logprob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.ActionHead.logprob" title="Link to this definition">#</a></dt>
<dd><p>Calculates the logarithm of the probability of sampling <cite>action_sample</cite>
from a probability distribution described by <cite>pd_params</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>action_sample</strong> (<em>Any</em>) – The sampled action.</p></li>
<li><p><strong>pd_params</strong> (<em>Any</em>) – Parameters describing the probability distribution.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The log probability of the action sample.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – This method must be implemented by subclasses.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.ActionHead.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pd_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#ActionHead.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.ActionHead.sample" title="Link to this definition">#</a></dt>
<dd><p>Draws a sample from the probability distribution given by <cite>pd_params</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pd_params</strong> (<em>Any</em>) – Parameters of a probability distribution.</p></li>
<li><p><strong>deterministic</strong> (<em>bool</em>) – Whether to return a stochastic sample or the deterministic mode of the distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A sampled action.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – This method must be implemented by subclasses.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.CategoricalActionHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.utils.vpt_lib.action_head.</span></span><span class="sig-name descname"><span class="pre">CategoricalActionHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#CategoricalActionHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.CategoricalActionHead" title="Link to this definition">#</a></dt>
<dd><p>Action head for categorical (discrete) actions.
It uses a linear layer to produce logits for each action.
Supports temperature scaling and nucleus sampling.</p>
<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.CategoricalActionHead.entropy">
<span class="sig-name descname"><span class="pre">entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#CategoricalActionHead.entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.CategoricalActionHead.entropy" title="Link to this definition">#</a></dt>
<dd><p>Calculates the entropy of the categorical distribution defined by <cite>logits</cite>.
Entropy = - sum(probs * log_probs).
The result is summed if the action space has multiple dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>logits</strong> (<em>torch.Tensor</em>) – The log probabilities (output of the forward pass).
Shape: (…, <a href="#id1"><span class="problematic" id="id2">*</span></a>self.output_shape)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The entropy of the distribution. Shape: (…)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.CategoricalActionHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#CategoricalActionHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.CategoricalActionHead.forward" title="Link to this definition">#</a></dt>
<dd><p>Computes the log probabilities (logits) for each action.
Applies temperature scaling and masking if provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_data</strong> (<em>torch.Tensor</em>) – The input tensor from the policy network.</p></li>
<li><p><strong>mask</strong> (<em>Optional</em><em>[</em><em>torch.Tensor</em><em>]</em>) – An optional boolean mask. Logits for masked-out actions are set to a very small number (LOG0).
Shape should be broadcastable to the logits shape before the num_actions dimension.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Logits for each action after processing. Shape: (…, <a href="#id3"><span class="problematic" id="id4">*</span></a>self.output_shape)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.CategoricalActionHead.kl_divergence">
<span class="sig-name descname"><span class="pre">kl_divergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits_q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logits_p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#CategoricalActionHead.kl_divergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.CategoricalActionHead.kl_divergence" title="Link to this definition">#</a></dt>
<dd><p>Calculates the KL divergence KL(Q || P) between two categorical distributions Q and P,
defined by their logits.
Formula: sum(exp(Q_i) * (Q_i - P_i)).
The result is summed if the action space has multiple dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logits_q</strong> (<em>torch.Tensor</em>) – Logits of the first distribution Q.
Shape: (…, <a href="#id5"><span class="problematic" id="id6">*</span></a>self.output_shape)</p></li>
<li><p><strong>logits_p</strong> (<em>torch.Tensor</em>) – Logits of the second distribution P.
Shape: (…, <a href="#id7"><span class="problematic" id="id8">*</span></a>self.output_shape)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The KL divergence. Shape: (…, 1)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.CategoricalActionHead.logprob">
<span class="sig-name descname"><span class="pre">logprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#CategoricalActionHead.logprob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.CategoricalActionHead.logprob" title="Link to this definition">#</a></dt>
<dd><p>Calculates the log probability of the given <cite>actions</cite> based on the <cite>logits</cite>.
It gathers the log probabilities corresponding to the chosen actions and sums them
if the action space has multiple dimensions (e.g., for MultiDiscrete).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>actions</strong> (<em>torch.Tensor</em>) – The sampled actions. Expected to be long type.
Shape: (…, <a href="#id9"><span class="problematic" id="id10">*</span></a>self.output_shape[:-1])</p></li>
<li><p><strong>logits</strong> (<em>torch.Tensor</em>) – The log probabilities (output of the forward pass).
Shape: (…, <a href="#id11"><span class="problematic" id="id12">*</span></a>self.output_shape)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The sum of log probabilities for the chosen actions. Shape: (…)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.CategoricalActionHead.nucleus_sample">
<span class="sig-name descname"><span class="pre">nucleus_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.85</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#CategoricalActionHead.nucleus_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.CategoricalActionHead.nucleus_sample" title="Link to this definition">#</a></dt>
<dd><p>Samples an action using nucleus (top-p) sampling.
It considers the smallest set of actions whose cumulative probability exceeds <cite>p</cite>.
If deterministic, falls back to vanilla sampling with determinism.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logits</strong> (<em>torch.Tensor</em>) – The log probabilities for each action.
Shape: (…, <a href="#id13"><span class="problematic" id="id14">*</span></a>self.output_shape)</p></li>
<li><p><strong>deterministic</strong> (<em>bool</em>) – If True, uses vanilla deterministic sampling.</p></li>
<li><p><strong>p</strong> (<em>float</em>) – The cumulative probability threshold for nucleus sampling.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments (passed to vanilla_sample if deterministic).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A sampled action. Shape: (…, <a href="#id15"><span class="problematic" id="id16">*</span></a>self.output_shape[:-1])</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.CategoricalActionHead.reset_parameters">
<span class="sig-name descname"><span class="pre">reset_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#CategoricalActionHead.reset_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.CategoricalActionHead.reset_parameters" title="Link to this definition">#</a></dt>
<dd><p>Initializes the weights of the linear layer (if it exists) and biases.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.CategoricalActionHead.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#CategoricalActionHead.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.CategoricalActionHead.sample" title="Link to this definition">#</a></dt>
<dd><p>Samples an action from the categorical distribution.
Uses nucleus sampling if <cite>self.nucleus_prob</cite> is set, otherwise uses vanilla sampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logits</strong> (<em>torch.Tensor</em>) – The log probabilities for each action.
Shape: (…, <a href="#id17"><span class="problematic" id="id18">*</span></a>self.output_shape)</p></li>
<li><p><strong>deterministic</strong> (<em>bool</em>) – If True, returns the most likely action.
If False, returns a stochastic sample.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments for the specific sampling method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A sampled action. Shape: (…, <a href="#id19"><span class="problematic" id="id20">*</span></a>self.output_shape[:-1])</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.CategoricalActionHead.vanilla_sample">
<span class="sig-name descname"><span class="pre">vanilla_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#CategoricalActionHead.vanilla_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.CategoricalActionHead.vanilla_sample" title="Link to this definition">#</a></dt>
<dd><p>Samples an action from the categorical distribution using the Gumbel-Max trick for stochastic sampling,
or argmax for deterministic sampling. This is the original sampling method from the VPT library.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logits</strong> (<em>torch.Tensor</em>) – The log probabilities for each action.
Shape: (…, <a href="#id21"><span class="problematic" id="id22">*</span></a>self.output_shape)</p></li>
<li><p><strong>deterministic</strong> (<em>bool</em>) – If True, returns the action with the highest logit (argmax).
If False, returns a stochastic sample using Gumbel-Max.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments (not used).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A sampled action. Shape: (…, <a href="#id23"><span class="problematic" id="id24">*</span></a>self.output_shape[:-1])</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.DiagGaussianActionHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.utils.vpt_lib.action_head.</span></span><span class="sig-name descname"><span class="pre">DiagGaussianActionHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#DiagGaussianActionHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.DiagGaussianActionHead" title="Link to this definition">#</a></dt>
<dd><p>Action head for normally distributed, uncorrelated continuous actions.
Means are predicted by a linear layer, while standard deviations are learnable parameters.</p>
<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.DiagGaussianActionHead.entropy">
<span class="sig-name descname"><span class="pre">entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pd_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#DiagGaussianActionHead.entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.DiagGaussianActionHead.entropy" title="Link to this definition">#</a></dt>
<dd><p>Calculates the entropy of the Gaussian distribution.
For a diagonal Gaussian, entropy is 0.5 * sum(log(2 * pi * e * sigma_i^2)).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pd_params</strong> (<em>torch.Tensor</em>) – Parameters of the Gaussian distribution (means and log_stds).
Shape: (…, num_dimensions, 2)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The entropy of the distribution. Shape: (…)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.DiagGaussianActionHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#DiagGaussianActionHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.DiagGaussianActionHead.forward" title="Link to this definition">#</a></dt>
<dd><p>Computes the means and log standard deviations of the Gaussian distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_data</strong> (<em>torch.Tensor</em>) – The input tensor from the policy network.</p></li>
<li><p><strong>mask</strong> (<em>Optional</em><em>[</em><em>torch.Tensor</em><em>]</em>) – An optional mask (not used in this head).</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor where the last dimension contains means and log_stds.
Shape: (…, num_dimensions, 2)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – If a mask is provided.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.DiagGaussianActionHead.kl_divergence">
<span class="sig-name descname"><span class="pre">kl_divergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params_q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#DiagGaussianActionHead.kl_divergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.DiagGaussianActionHead.kl_divergence" title="Link to this definition">#</a></dt>
<dd><p>Calculates the KL divergence KL(Q || P) between two diagonal Gaussian distributions Q and P.
Formula: log(sigma_p/sigma_q) + (sigma_q^2 + (mu_q - mu_p)^2) / (2 * sigma_p^2) - 0.5, summed over dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params_q</strong> (<em>torch.Tensor</em>) – Parameters of the first Gaussian distribution Q (means_q, log_std_q).
Shape: (…, num_dimensions, 2)</p></li>
<li><p><strong>params_p</strong> (<em>torch.Tensor</em>) – Parameters of the second Gaussian distribution P (means_p, log_std_p).
Shape: (…, num_dimensions, 2)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The KL divergence. Shape: (…, 1)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.DiagGaussianActionHead.logprob">
<span class="sig-name descname"><span class="pre">logprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action_sample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pd_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#DiagGaussianActionHead.logprob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.DiagGaussianActionHead.logprob" title="Link to this definition">#</a></dt>
<dd><p>Calculates the log-likelihood of <cite>action_sample</cite> given the distribution parameters.
The distribution is a multivariate Gaussian with a diagonal covariance matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>action_sample</strong> (<em>torch.Tensor</em>) – The sampled actions. Shape: (…, num_dimensions)</p></li>
<li><p><strong>pd_params</strong> (<em>torch.Tensor</em>) – Parameters of the Gaussian distribution (means and log_stds).
Shape: (…, num_dimensions, 2)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The log probability of the action samples. Shape: (…)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.DiagGaussianActionHead.reset_parameters">
<span class="sig-name descname"><span class="pre">reset_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#DiagGaussianActionHead.reset_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.DiagGaussianActionHead.reset_parameters" title="Link to this definition">#</a></dt>
<dd><p>Initializes the weights of the linear layer and biases.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.DiagGaussianActionHead.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pd_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#DiagGaussianActionHead.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.DiagGaussianActionHead.sample" title="Link to this definition">#</a></dt>
<dd><p>Samples an action from the Gaussian distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pd_params</strong> (<em>torch.Tensor</em>) – Parameters of the Gaussian distribution (means and log_stds).
Shape: (…, num_dimensions, 2)</p></li>
<li><p><strong>deterministic</strong> (<em>bool</em>) – If True, returns the mean (mode) of the distribution.
If False, returns a stochastic sample.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A sampled action. Shape: (…, num_dimensions)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.DictActionHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.utils.vpt_lib.action_head.</span></span><span class="sig-name descname"><span class="pre">DictActionHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#DictActionHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.DictActionHead" title="Link to this definition">#</a></dt>
<dd><p>An action head that combines multiple sub-action heads, where actions are structured as a dictionary.
Each key-value pair in the dictionary corresponds to an action from a named sub-head.
Inherits from <cite>nn.ModuleDict</cite> to manage sub-heads and <cite>ActionHead</cite> for the interface.</p>
<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.DictActionHead.entropy">
<span class="sig-name descname"><span class="pre">entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#DictActionHead.entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.DictActionHead.entropy" title="Link to this definition">#</a></dt>
<dd><p>Calculates the entropy for each sub-distribution.
Can return a dictionary of entropies or their sum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logits</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em>) – A dictionary of pd_params from each sub-head, keyed by sub-head name.</p></li>
<li><p><strong>return_dict</strong> (<em>bool</em>) – If True, returns a dictionary of entropies.
If False, returns the sum of entropies.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Either a sum of entropies (Tensor) or a dictionary of entropies.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[torch.Tensor, Dict[str, torch.Tensor]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.DictActionHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#DictActionHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.DictActionHead.forward" title="Link to this definition">#</a></dt>
<dd><p>Passes input data through each sub-head. Allows passing specific keyword arguments
to individual sub-heads based on their keys.</p>
<p>Example:
If this ModuleDict has submodules keyed by ‘A’, ‘B’, and ‘C’, we could call:
<cite>forward(input_data, foo={‘A’: True, ‘C’: False}, bar={‘A’: 7})</cite>
Then children will be called with:</p>
<blockquote>
<div><p>A: <cite>subhead_A(input_data, foo=True, bar=7)</cite>
B: <cite>subhead_B(input_data)</cite>
C: <cite>subhead_C(input_data, foo=False)</cite></p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_data</strong> (<em>torch.Tensor</em>) – The input tensor from the policy network.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments. If a kwarg’s value is a dictionary, its items
are passed to sub-heads matching the keys.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary where keys are sub-head names and values are their outputs (pd_params).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.DictActionHead.kl_divergence">
<span class="sig-name descname"><span class="pre">kl_divergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits_q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logits_p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#DictActionHead.kl_divergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.DictActionHead.kl_divergence" title="Link to this definition">#</a></dt>
<dd><p>Calculates the KL divergence for each pair of sub-distributions (Q_k || P_k)
and returns their sum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logits_q</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em>) – A dictionary of parameters for the first set of distributions (Q).</p></li>
<li><p><strong>logits_p</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em>) – A dictionary of parameters for the second set of distributions (P).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The sum of KL divergences from all sub-heads.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.DictActionHead.logprob">
<span class="sig-name descname"><span class="pre">logprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#DictActionHead.logprob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.DictActionHead.logprob" title="Link to this definition">#</a></dt>
<dd><p>Calculates log probabilities for actions from each sub-head.
Can return a dictionary of log probabilities or their sum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>actions</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em>) – A dictionary of sampled actions, keyed by sub-head name.</p></li>
<li><p><strong>logits</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em>) – A dictionary of pd_params from each sub-head, keyed by sub-head name.</p></li>
<li><p><strong>return_dict</strong> (<em>bool</em>) – If True, returns a dictionary of log probabilities.
If False, returns the sum of log probabilities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Either a sum of log probabilities (Tensor) or a dictionary of log probabilities.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[torch.Tensor, Dict[str, torch.Tensor]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.DictActionHead.reset_parameters">
<span class="sig-name descname"><span class="pre">reset_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#DictActionHead.reset_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.DictActionHead.reset_parameters" title="Link to this definition">#</a></dt>
<dd><p>Calls <cite>reset_parameters</cite> on each sub-head in the dictionary.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.DictActionHead.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#DictActionHead.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.DictActionHead.sample" title="Link to this definition">#</a></dt>
<dd><p>Samples an action from each sub-head and returns a dictionary of these actions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logits</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em>) – A dictionary of pd_params from each sub-head, keyed by sub-head name.</p></li>
<li><p><strong>deterministic</strong> (<em>bool</em>) – Whether to perform deterministic sampling for each sub-head.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of sampled actions, keyed by sub-head name.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.MSEActionHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.utils.vpt_lib.action_head.</span></span><span class="sig-name descname"><span class="pre">MSEActionHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#MSEActionHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.MSEActionHead" title="Link to this definition">#</a></dt>
<dd><p>Action head for continuous actions where the loss is Mean Squared Error (MSE)
between the predicted actions (means) and the target actions.
This head essentially predicts the mean of a distribution with fixed, infinitesimal variance.</p>
<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.MSEActionHead.entropy">
<span class="sig-name descname"><span class="pre">entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pd_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#MSEActionHead.entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.MSEActionHead.entropy" title="Link to this definition">#</a></dt>
<dd><p>Returns zero entropy, as this head represents a deterministic prediction (delta distribution).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pd_params</strong> (<em>torch.Tensor</em>) – The predicted mean actions.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor of zeros with the same batch shape as pd_params. Shape: (…)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.MSEActionHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#MSEActionHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.MSEActionHead.forward" title="Link to this definition">#</a></dt>
<dd><p>Computes the predicted mean actions using a linear layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_data</strong> (<em>torch.Tensor</em>) – The input tensor from the policy network.</p></li>
<li><p><strong>mask</strong> (<em>Optional</em><em>[</em><em>torch.Tensor</em><em>]</em>) – An optional mask (not used in this head).</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The predicted mean actions. Shape: (…, num_dimensions)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – If a mask is provided.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.MSEActionHead.kl_divergence">
<span class="sig-name descname"><span class="pre">kl_divergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params_q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#MSEActionHead.kl_divergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.MSEActionHead.kl_divergence" title="Link to this definition">#</a></dt>
<dd><p>KL divergence is not well-defined for this action head in a general sense
as it represents a delta distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params_q</strong> (<em>torch.Tensor</em>) – Parameters of the first distribution.</p></li>
<li><p><strong>params_p</strong> (<em>torch.Tensor</em>) – Parameters of the second distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – This method is not implemented.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.MSEActionHead.logprob">
<span class="sig-name descname"><span class="pre">logprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action_sample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pd_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#MSEActionHead.logprob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.MSEActionHead.logprob" title="Link to this definition">#</a></dt>
<dd><p>Calculates a pseudo log-probability, which is the negative squared error.
This is not a true log-probability but is used for compatibility in some RL frameworks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>action_sample</strong> (<em>torch.Tensor</em>) – The target actions. Shape: (…, num_dimensions)</p></li>
<li><p><strong>pd_params</strong> (<em>torch.Tensor</em>) – The predicted mean actions (output of the forward pass).
Shape: (…, num_dimensions)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The negative sum of squared errors. Shape: (…)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.MSEActionHead.reset_parameters">
<span class="sig-name descname"><span class="pre">reset_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#MSEActionHead.reset_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.MSEActionHead.reset_parameters" title="Link to this definition">#</a></dt>
<dd><p>Initializes the weights of the linear layer and biases.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.MSEActionHead.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pd_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#MSEActionHead.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.MSEActionHead.sample" title="Link to this definition">#</a></dt>
<dd><p>Returns the predicted mean actions, as this head is deterministic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pd_params</strong> (<em>torch.Tensor</em>) – The predicted mean actions (output of the forward pass).
Shape: (…, num_dimensions)</p></li>
<li><p><strong>deterministic</strong> (<em>bool</em>) – Ignored, as sampling is always deterministic.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments (not used).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The predicted mean actions. Shape: (…, num_dimensions)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.TupleActionHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.utils.vpt_lib.action_head.</span></span><span class="sig-name descname"><span class="pre">TupleActionHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#TupleActionHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.TupleActionHead" title="Link to this definition">#</a></dt>
<dd><p>An action head that combines multiple sub-action heads, where actions are structured as a tuple.
Each element of the tuple corresponds to an action from a sub-head.
Inherits from <cite>nn.ModuleList</cite> to manage sub-heads and <cite>ActionHead</cite> for the interface.</p>
<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.TupleActionHead.entropy">
<span class="sig-name descname"><span class="pre">entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#TupleActionHead.entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.TupleActionHead.entropy" title="Link to this definition">#</a></dt>
<dd><p>Calculates the entropy for each sub-distribution and returns a tuple of entropies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>logits</strong> (<em>Tuple</em><em>[</em><em>torch.Tensor</em><em>, </em><em>...</em><em>]</em>) – A tuple of probability distribution parameters from each sub-head.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple of entropies, one for each sub-distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, …]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.TupleActionHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#TupleActionHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.TupleActionHead.forward" title="Link to this definition">#</a></dt>
<dd><p>Passes the input data through each sub-head and returns a tuple of their outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_data</strong> (<em>torch.Tensor</em>) – The input tensor from the policy network.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments (passed to each sub-head).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple where each element is the output (pd_params) of a sub-head.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[Any, …]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.TupleActionHead.kl_divergence">
<span class="sig-name descname"><span class="pre">kl_divergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits_q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logits_p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#TupleActionHead.kl_divergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.TupleActionHead.kl_divergence" title="Link to this definition">#</a></dt>
<dd><p>Calculates the KL divergence for each pair of sub-distributions (Q_k || P_k)
and returns their sum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logits_q</strong> (<em>Tuple</em><em>[</em><em>torch.Tensor</em><em>, </em><em>...</em><em>]</em>) – A tuple of parameters for the first set of distributions (Q).</p></li>
<li><p><strong>logits_p</strong> (<em>Tuple</em><em>[</em><em>torch.Tensor</em><em>, </em><em>...</em><em>]</em>) – A tuple of parameters for the second set of distributions (P).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The sum of KL divergences from all sub-heads.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.TupleActionHead.logprob">
<span class="sig-name descname"><span class="pre">logprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#TupleActionHead.logprob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.TupleActionHead.logprob" title="Link to this definition">#</a></dt>
<dd><p>Calculates the log probability for each action in the tuple using the corresponding sub-head
and its logits. Returns a tuple of log probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>actions</strong> (<em>Tuple</em><em>[</em><em>torch.Tensor</em><em>, </em><em>...</em><em>]</em>) – A tuple of sampled actions, one for each sub-head.</p></li>
<li><p><strong>logits</strong> (<em>Tuple</em><em>[</em><em>torch.Tensor</em><em>, </em><em>...</em><em>]</em>) – A tuple of probability distribution parameters (e.g., logits) from each sub-head.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple of log probabilities, one for each sub-action.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, …]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.TupleActionHead.reset_parameters">
<span class="sig-name descname"><span class="pre">reset_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#TupleActionHead.reset_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.TupleActionHead.reset_parameters" title="Link to this definition">#</a></dt>
<dd><p>Calls <cite>reset_parameters</cite> on each sub-head.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.TupleActionHead.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#TupleActionHead.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.TupleActionHead.sample" title="Link to this definition">#</a></dt>
<dd><p>Samples an action from each sub-head and returns a tuple of these actions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logits</strong> (<em>Tuple</em><em>[</em><em>torch.Tensor</em><em>, </em><em>...</em><em>]</em>) – A tuple of probability distribution parameters from each sub-head.</p></li>
<li><p><strong>deterministic</strong> (<em>bool</em>) – Whether to perform deterministic sampling for each sub-head.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple of sampled actions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[Any, …]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.fan_in_linear">
<span class="sig-prename descclassname"><span class="pre">minestudio.utils.vpt_lib.action_head.</span></span><span class="sig-name descname"><span class="pre">fan_in_linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#fan_in_linear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.fan_in_linear" title="Link to this definition">#</a></dt>
<dd><p>Initializes the weights of a linear module using fan-in initialization.
The weights are scaled by <cite>scale / norm</cite>, where norm is the L2 norm of the weights.
Biases are initialized to zero if <cite>bias</cite> is True.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>module</strong> (<em>nn.Module</em>) – The linear module to initialize.</p></li>
<li><p><strong>scale</strong> (<em>float</em>) – The scaling factor for the weights.</p></li>
<li><p><strong>bias</strong> (<em>bool</em>) – Whether to initialize biases to zero.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.action_head.make_action_head">
<span class="sig-prename descclassname"><span class="pre">minestudio.utils.vpt_lib.action_head.</span></span><span class="sig-name descname"><span class="pre">make_action_head</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ac_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">gym3.types.ValType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi_out_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/action_head.html#make_action_head"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.action_head.make_action_head" title="Link to this definition">#</a></dt>
<dd><p>Helper function to create an appropriate action head based on the action space type.
Supports <cite>gymnasium.spaces</cite> and some <cite>gym.spaces</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ac_space</strong> (<em>Union</em><em>[</em><em>gymnasium.spaces.Space</em><em>, </em><em>gym.spaces.Space</em><em>, </em><em>ValType</em><em>]</em>) – The action space of the environment.</p></li>
<li><p><strong>pi_out_size</strong> (<em>int</em>) – The output size of the policy network feature extractor.</p></li>
<li><p><strong>temperature</strong> (<em>float</em>) – Temperature for categorical action heads.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to pass to the action head constructor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An initialized action head.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#minestudio.utils.vpt_lib.action_head.ActionHead" title="minestudio.utils.vpt_lib.action_head.ActionHead">ActionHead</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – If the action space type is not supported.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-minestudio.utils.vpt_lib.scaled_mse_head">
<span id="value-head"></span><h3>Value Head<a class="headerlink" href="#module-minestudio.utils.vpt_lib.scaled_mse_head" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.scaled_mse_head.ScaledMSEHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.utils.vpt_lib.scaled_mse_head.</span></span><span class="sig-name descname"><span class="pre">ScaledMSEHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ewma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/scaled_mse_head.html#ScaledMSEHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.scaled_mse_head.ScaledMSEHead" title="Link to this definition">#</a></dt>
<dd><p>A linear output layer that normalizes its targets to have a mean of 0 and a standard deviation of 1.
This is achieved by using an Exponential Moving Average (EWMA) normalizer on the targets
before calculating the Mean Squared Error (MSE) loss. The predictions are made in the
original (unnormalized) space, but the loss is computed in the normalized space.</p>
<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.scaled_mse_head.ScaledMSEHead.denormalize">
<span class="sig-name descname"><span class="pre">denormalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/scaled_mse_head.html#ScaledMSEHead.denormalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.scaled_mse_head.ScaledMSEHead.denormalize" title="Link to this definition">#</a></dt>
<dd><p>Converts an input value from the normalized space back into the original space
using the inverse operation of the internal normalizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_data</strong> (<em>torch.Tensor</em>) – The data in the normalized space.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The data in the original space.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.scaled_mse_head.ScaledMSEHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/scaled_mse_head.html#ScaledMSEHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.scaled_mse_head.ScaledMSEHead.forward" title="Link to this definition">#</a></dt>
<dd><p>Performs a forward pass through the linear layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_data</strong> (<em>torch.Tensor</em>) – The input tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The output of the linear layer (predictions in the original space).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.scaled_mse_head.ScaledMSEHead.loss">
<span class="sig-name descname"><span class="pre">loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/scaled_mse_head.html#ScaledMSEHead.loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.scaled_mse_head.ScaledMSEHead.loss" title="Link to this definition">#</a></dt>
<dd><p>Calculates the Mean Squared Error (MSE) loss between the prediction and the target.
The target is first normalized using the internal EWMA normalizer.
The loss is computed in this normalized space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prediction</strong> (<em>torch.Tensor</em>) – The predicted output from the forward pass (in original space).</p></li>
<li><p><strong>target</strong> (<em>torch.Tensor</em>) – The target values (in original space).</p></li>
<li><p><strong>reduction</strong> (<em>str</em>) – Specifies the reduction to apply to the output: ‘none’ | ‘mean’ | ‘sum’.
‘none’: no reduction will be applied,
‘mean’: the sum of the output will be divided by the number of elements in the output,
‘sum’: the output will be summed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The MSE loss.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.scaled_mse_head.ScaledMSEHead.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/scaled_mse_head.html#ScaledMSEHead.normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.scaled_mse_head.ScaledMSEHead.normalize" title="Link to this definition">#</a></dt>
<dd><p>Normalizes the input data using the internal EWMA normalizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_data</strong> (<em>torch.Tensor</em>) – The data in the original space.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The data in the normalized space.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.utils.vpt_lib.scaled_mse_head.ScaledMSEHead.reset_parameters">
<span class="sig-name descname"><span class="pre">reset_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/utils/vpt_lib/scaled_mse_head.html#ScaledMSEHead.reset_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.utils.vpt_lib.scaled_mse_head.ScaledMSEHead.reset_parameters" title="Link to this definition">#</a></dt>
<dd><p>Initializes the weights of the linear layer and resets the normalizer’s parameters.
The linear layer’s weights are initialized orthogonally and then scaled using fan-in initialization.</p>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="module-minestudio.models.groot_one.body">
<span id="grootone"></span><h2>GrootOne<a class="headerlink" href="#module-minestudio.models.groot_one.body" title="Link to this heading">#</a></h2>
<p>Date: 2024-11-25 07:03:41
LastEditors: caishaofei <a class="reference external" href="mailto:caishaofei&#37;&#52;&#48;stu&#46;pku&#46;edu&#46;cn">caishaofei<span>&#64;</span>stu<span>&#46;</span>pku<span>&#46;</span>edu<span>&#46;</span>cn</a>
LastEditTime: 2025-01-07 14:21:06
FilePath: /MineStudio/minestudio/models/groot_one/body.py</p>
<dl class="py class">
<dt class="sig sig-object py" id="minestudio.models.groot_one.body.Decoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.models.groot_one.body.</span></span><span class="sig-name descname"><span class="pre">Decoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hiddim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mem_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/groot_one/body.html#Decoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.groot_one.body.Decoder" title="Link to this definition">#</a></dt>
<dd><p>Decodes a sequence of latent vectors using a recurrent Transformer architecture.</p>
<p>This module is typically used to generate sequences for policy and value estimation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hiddim</strong> (<em>int</em>) – The hidden dimension of the model.</p></li>
<li><p><strong>num_heads</strong> (<em>int</em>) – Number of attention heads in the recurrent Transformer blocks.
Defaults to 8.</p></li>
<li><p><strong>num_layers</strong> (<em>int</em>) – Number of recurrent Transformer blocks. Defaults to 4.</p></li>
<li><p><strong>timesteps</strong> (<em>int</em>) – The number of timesteps the recurrent model processes at once.
Defaults to 128.</p></li>
<li><p><strong>mem_len</strong> (<em>int</em>) – The length of the memory used by the causal attention mechanism.
Defaults to 128.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.groot_one.body.Decoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/minestudio/models/groot_one/body.html#Decoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.groot_one.body.Decoder.forward" title="Link to this definition">#</a></dt>
<dd><p>Forward pass of the Decoder.</p>
<p>Processes the input sequence <cite>x</cite> using the recurrent Transformer blocks,
updating the <cite>memory</cite> (recurrent state).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – Input tensor of shape (b, t, c), where b=batch_size, t=sequence_length, c=features.</p></li>
<li><p><strong>memory</strong> (<em>List</em><em>[</em><em>torch.Tensor</em><em>]</em>) – The recurrent state from the previous step. If None, an initial state is created.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing:
- x (torch.Tensor): The output tensor of shape (b, t, c).
- memory (List[torch.Tensor]): The updated recurrent state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, List[torch.Tensor]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.groot_one.body.Decoder.initial_state">
<span class="sig-name descname"><span class="pre">initial_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/minestudio/models/groot_one/body.html#Decoder.initial_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.groot_one.body.Decoder.initial_state" title="Link to this definition">#</a></dt>
<dd><p>Returns the initial recurrent state for the decoder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch_size</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – The batch size for the initial state. If None, returns state for batch_size=1.
Defaults to None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of tensors representing the initial recurrent state, moved to the model’s device.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="minestudio.models.groot_one.body.GrootPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.models.groot_one.body.</span></span><span class="sig-name descname"><span class="pre">GrootPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/groot_one/body.html#GrootPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.groot_one.body.GrootPolicy" title="Link to this definition">#</a></dt>
<dd><p>GrootPolicy model for Minecraft, combining visual encoders and a recurrent decoder.</p>
<p>This policy uses a pre-trained backbone (e.g., EfficientNet, ViT) to extract features
from images. It has separate encoders for video sequences (reference trajectory)
and single images (current observation). The features are fused and then processed
by a recurrent decoder to produce policy and value outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>backbone</strong> (<em>str</em>) – Name of the timm model to use as a backbone (e.g., ‘efficientnet_b0.ra_in1k’).</p></li>
<li><p><strong>freeze_backbone</strong> (<em>bool</em>) – Whether to freeze the weights of the pre-trained backbone. Defaults to True.</p></li>
<li><p><strong>hiddim</strong> (<em>int</em>) – Hidden dimension for the policy network. Defaults to 1024.</p></li>
<li><p><strong>video_encoder_kwargs</strong> (<em>Dict</em>) – Keyword arguments for the <cite>VideoEncoder</cite>. Defaults to {}.</p></li>
<li><p><strong>image_encoder_kwargs</strong> (<em>Dict</em>) – Keyword arguments for the <cite>ImageEncoder</cite>. Defaults to {}.</p></li>
<li><p><strong>decoder_kwargs</strong> (<em>Dict</em>) – Keyword arguments for the <cite>Decoder</cite>. Defaults to {}.</p></li>
<li><p><strong>action_space</strong> (<em>Optional</em><em>[</em><em>Any</em><em>]</em>) – The action space definition. Passed to <cite>MinePolicy</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.groot_one.body.GrootPolicy.encode_video">
<span class="sig-name descname"><span class="pre">encode_video</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_video_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(224,</span> <span class="pre">224)</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../../_modules/minestudio/models/groot_one/body.html#GrootPolicy.encode_video"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.groot_one.body.GrootPolicy.encode_video" title="Link to this definition">#</a></dt>
<dd><p>Encodes a reference video from a file path into prior and posterior latent distributions.</p>
<p>Reads a video file, extracts frames, preprocesses them using the backbone,
and then uses the VideoEncoder and ImageEncoder to get latent distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref_video_path</strong> (<em>str</em>) – Path to the reference video file.</p></li>
<li><p><strong>resolution</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – Target resolution (width, height) to reformat video frames. Defaults to (224, 224).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing:
- ‘posterior_dist’ (Dict): Latent distribution from the VideoEncoder.
- ‘prior_dist’ (Dict): Latent distribution from the ImageEncoder (using the first frame).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Dict[str, torch.Tensor]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.groot_one.body.GrootPolicy.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../../_modules/minestudio/models/groot_one/body.html#GrootPolicy.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.groot_one.body.GrootPolicy.forward" title="Link to this definition">#</a></dt>
<dd><p>Forward pass of the GrootPolicy.</p>
<p>Processes the current image observation. If a <cite>ref_video_path</cite> is provided in the input
(inference mode), it encodes the reference video (or uses a cached encoding) to get
a condition <cite>z</cite>. If not (training mode), <cite>z</cite> is derived from the current batch of images.
The image features and <cite>z</cite> are fused and passed to the decoder to get policy and value outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>Dict</em>) – A dictionary of inputs. Expected to contain:
- ‘image’ (torch.Tensor): Current image observations (b, t, h, w, c).
- ‘ref_video_path’ (Optional[str] or Optional[List[str]]): Path to a reference video for conditioning (inference).</p></li>
<li><p><strong>memory</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>torch.Tensor</em><em>]</em><em>]</em>) – The recurrent state for the decoder. Defaults to None (initial state will be used).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing:
- latents (Dict): A dictionary with ‘pi_logits’, ‘vpred’, ‘posterior_dist’, and ‘prior_dist’.
- memory (List[torch.Tensor]): The updated recurrent state from the decoder.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[Dict[str, Any], List[torch.Tensor]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.groot_one.body.GrootPolicy.initial_state">
<span class="sig-name descname"><span class="pre">initial_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../../_modules/minestudio/models/groot_one/body.html#GrootPolicy.initial_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.groot_one.body.GrootPolicy.initial_state" title="Link to this definition">#</a></dt>
<dd><p>Returns the initial recurrent state for the policy (from the decoder).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – Positional arguments passed to the decoder’s <cite>initial_state</cite> method.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments passed to the decoder’s <cite>initial_state</cite> method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The initial recurrent state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="minestudio.models.groot_one.body.ImageEncoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.models.groot_one.body.</span></span><span class="sig-name descname"><span class="pre">ImageEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hiddim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/groot_one/body.html#ImageEncoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.groot_one.body.ImageEncoder" title="Link to this definition">#</a></dt>
<dd><p>Encodes a single image into a latent distribution.</p>
<p>Uses a Transformer encoder for spatial pooling, followed by a LatentSpace module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hiddim</strong> (<em>int</em>) – The hidden dimension for the model.</p></li>
<li><p><strong>num_layers</strong> (<em>int</em>) – Number of Transformer encoder layers for pooling. Defaults to 2.</p></li>
<li><p><strong>num_heads</strong> (<em>int</em>) – Number of attention heads in Transformer layers. Defaults to 8.</p></li>
<li><p><strong>dropout</strong> (<em>float</em>) – Dropout rate in Transformer layers. Defaults to 0.1.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.groot_one.body.ImageEncoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../../_modules/minestudio/models/groot_one/body.html#ImageEncoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.groot_one.body.ImageEncoder.forward" title="Link to this definition">#</a></dt>
<dd><p>Encodes a batch of images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>image</strong> (<em>torch.Tensor</em>) – A tensor of images with shape (b, c, h, w),
where b=batch_size, c=channels, h=height, w=width.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary representing the latent distribution from <cite>LatentSpace</cite>,
containing ‘mu’, ‘log_var’, and ‘z’.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="minestudio.models.groot_one.body.LatentSpace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.models.groot_one.body.</span></span><span class="sig-name descname"><span class="pre">LatentSpace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hiddim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/groot_one/body.html#LatentSpace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.groot_one.body.LatentSpace" title="Link to this definition">#</a></dt>
<dd><p>A module for creating a latent space with mean and log variance.</p>
<p>This module takes an input tensor, projects it to a mean (mu) and a
log variance (log_var), and then samples from the resulting Gaussian
distribution during training. During evaluation, it returns the mean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hiddim</strong> (<em>int</em>) – The hidden dimension of the input and latent space.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.groot_one.body.LatentSpace.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../../_modules/minestudio/models/groot_one/body.html#LatentSpace.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.groot_one.body.LatentSpace.forward" title="Link to this definition">#</a></dt>
<dd><p>Forward pass to compute latent variable z, its mean mu, and log variance log_var.</p>
<p>During training, z is sampled from the distribution. During evaluation, z is mu.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – The input tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing:
- ‘mu’ (torch.Tensor): The mean of the latent distribution.
- ‘log_var’ (torch.Tensor): The log variance of the latent distribution.
- ‘z’ (torch.Tensor): The sampled (training) or mean (evaluation) latent variable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.groot_one.body.LatentSpace.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_var</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../../_modules/minestudio/models/groot_one/body.html#LatentSpace.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.groot_one.body.LatentSpace.sample" title="Link to this definition">#</a></dt>
<dd><p>Samples from a Gaussian distribution defined by mu and log_var.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>torch.Tensor</em>) – The mean of the Gaussian distribution.</p></li>
<li><p><strong>log_var</strong> (<em>torch.Tensor</em>) – The logarithm of the variance of the Gaussian distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor sampled from the N(mu, exp(log_var)) distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="minestudio.models.groot_one.body.VideoEncoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.models.groot_one.body.</span></span><span class="sig-name descname"><span class="pre">VideoEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hiddim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_spatial_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_temporal_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/groot_one/body.html#VideoEncoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.groot_one.body.VideoEncoder" title="Link to this definition">#</a></dt>
<dd><p>Encodes a sequence of video frames into a latent distribution.</p>
<p>It uses Transformer encoders for spatial pooling within frames and temporal
encoding across frames, followed by a LatentSpace module to get a distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hiddim</strong> (<em>int</em>) – The hidden dimension for the model.</p></li>
<li><p><strong>num_spatial_layers</strong> (<em>int</em>) – Number of Transformer encoder layers for spatial pooling.
Defaults to 2.</p></li>
<li><p><strong>num_temporal_layers</strong> (<em>int</em>) – Number of Transformer encoder layers for temporal encoding.
Defaults to 2.</p></li>
<li><p><strong>num_heads</strong> (<em>int</em>) – Number of attention heads in Transformer layers. Defaults to 8.</p></li>
<li><p><strong>dropout</strong> (<em>float</em>) – Dropout rate in Transformer layers. Defaults to 0.1.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.groot_one.body.VideoEncoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../../_modules/minestudio/models/groot_one/body.html#VideoEncoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.groot_one.body.VideoEncoder.forward" title="Link to this definition">#</a></dt>
<dd><p>Encodes a batch of video frames.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>images</strong> (<em>torch.Tensor</em>) – A tensor of video frames with shape (b, t, c, h, w),
where b=batch_size, t=time_steps, c=channels, h=height, w=width.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary representing the latent distribution from <cite>LatentSpace</cite>,
containing ‘mu’, ‘log_var’, and ‘z’.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="minestudio.models.groot_one.body.load_groot_policy">
<span class="sig-prename descclassname"><span class="pre">minestudio.models.groot_one.body.</span></span><span class="sig-name descname"><span class="pre">load_groot_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpt_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/groot_one/body.html#load_groot_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.groot_one.body.load_groot_policy" title="Link to this definition">#</a></dt>
<dd><p>Loads a GrootPolicy model.</p>
<p>If <cite>ckpt_path</cite> is provided, it loads the model from the checkpoint.
Otherwise, it loads a pre-trained model from Hugging Face Hub.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ckpt_path</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Path to a .ckpt model checkpoint file. Defaults to None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The loaded GrootPolicy model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#minestudio.models.groot_one.body.GrootPolicy" title="minestudio.models.groot_one.body.GrootPolicy">GrootPolicy</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="minestudio.models.groot_one.body.peel_off">
<span class="sig-prename descclassname"><span class="pre">minestudio.models.groot_one.body.</span></span><span class="sig-name descname"><span class="pre">peel_off</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../_modules/minestudio/models/groot_one/body.html#peel_off"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.groot_one.body.peel_off" title="Link to this definition">#</a></dt>
<dd><p>Recursively extracts a string from a potentially nested list of strings.</p>
<p>If the item is a list, it calls itself with the first element of the list.
If the item is a string, it returns the string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>item</strong> (<em>Union</em><em>[</em><em>List</em><em>, </em><em>str</em><em>]</em>) – The item to peel, which can be a string or a list containing strings or other lists.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The innermost string found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-minestudio.models.rocket_one.body">
<span id="rocketone"></span><h2>RocketOne<a class="headerlink" href="#module-minestudio.models.rocket_one.body" title="Link to this heading">#</a></h2>
<p>Date: 2024-11-10 15:52:16
LastEditors: caishaofei-mus1 <a class="reference external" href="mailto:1744260356&#37;&#52;&#48;qq&#46;com">1744260356<span>&#64;</span>qq<span>&#46;</span>com</a>
LastEditTime: 2025-01-15 17:08:36
FilePath: /MineStudio/minestudio/models/rocket_one/body.py</p>
<dl class="py class">
<dt class="sig sig-object py" id="minestudio.models.rocket_one.body.RocketPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.models.rocket_one.body.</span></span><span class="sig-name descname"><span class="pre">RocketPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/rocket_one/body.html#RocketPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.rocket_one.body.RocketPolicy" title="Link to this definition">#</a></dt>
<dd><p>RocketPolicy model for Minecraft, using a Vision Transformer (ViT) backbone.</p>
<p>This policy processes an RGB image concatenated with an object mask. It uses a
pre-trained ViT backbone for feature extraction, followed by Transformer-based
pooling and recurrent blocks for temporal processing. It also incorporates an
embedding for interaction types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>backbone</strong> (<em>str</em>) – Name of the timm model to use as a backbone (e.g., ‘timm/vit_base_patch16_224.dino’).
Defaults to ‘timm/vit_base_patch16_224.dino’.</p></li>
<li><p><strong>hiddim</strong> (<em>int</em>) – Hidden dimension for the policy network. Defaults to 1024.</p></li>
<li><p><strong>num_heads</strong> (<em>int</em>) – Number of attention heads in Transformer layers. Defaults to 8.</p></li>
<li><p><strong>num_layers</strong> (<em>int</em>) – Number of recurrent Transformer blocks. Defaults to 4.</p></li>
<li><p><strong>timesteps</strong> (<em>int</em>) – The number of timesteps the recurrent model processes at once. Defaults to 128.</p></li>
<li><p><strong>mem_len</strong> (<em>int</em>) – The length of the memory used by the causal attention mechanism in recurrent blocks.
Defaults to 128.</p></li>
<li><p><strong>action_space</strong> (<em>Optional</em><em>[</em><em>Any</em><em>]</em>) – The action space definition. Passed to <cite>MinePolicy</cite>. Defaults to None.</p></li>
<li><p><strong>nucleus_prob</strong> (<em>float</em>) – Nucleus probability for sampling actions. Passed to <cite>MinePolicy</cite>.
Defaults to 0.85.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.rocket_one.body.RocketPolicy.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../../_modules/minestudio/models/rocket_one/body.html#RocketPolicy.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.rocket_one.body.RocketPolicy.forward" title="Link to this definition">#</a></dt>
<dd><p>Forward pass of the RocketPolicy.</p>
<p>Processes the input image and segmentation mask, extracts features, and passes them
through recurrent layers to produce policy and value predictions.</p>
<p>Input dictionary is expected to contain:
- ‘image’: (b, t, h, w, c) tensor of RGB images.
- ‘segment’ or ‘segmentation’: Dictionary containing:</p>
<blockquote>
<div><ul class="simple">
<li><p>‘obj_mask’: (b, t, h, w) tensor of object masks.</p></li>
<li><p>‘obj_id’: (b, t) tensor of object interaction type IDs.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>Dict</em>) – Dictionary of input tensors.</p></li>
<li><p><strong>memory</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>torch.Tensor</em><em>]</em><em>]</em>) – Optional list of recurrent state tensors. If None, an initial state is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing:
- latents (Dict): Dictionary with ‘pi_logits’ and ‘vpred’.
- memory (List[torch.Tensor]): Updated list of recurrent state tensors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[Dict[str, torch.Tensor], List[torch.Tensor]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.rocket_one.body.RocketPolicy.initial_state">
<span class="sig-name descname"><span class="pre">initial_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/minestudio/models/rocket_one/body.html#RocketPolicy.initial_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.rocket_one.body.RocketPolicy.initial_state" title="Link to this definition">#</a></dt>
<dd><p>Returns the initial recurrent state for the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch_size</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – The batch size for the initial state. If None, returns state for batch_size=1.
Defaults to None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of tensors representing the initial recurrent state, moved to the model’s device.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="minestudio.models.rocket_one.body.load_rocket_policy">
<span class="sig-prename descclassname"><span class="pre">minestudio.models.rocket_one.body.</span></span><span class="sig-name descname"><span class="pre">load_rocket_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpt_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/rocket_one/body.html#load_rocket_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.rocket_one.body.load_rocket_policy" title="Link to this definition">#</a></dt>
<dd><p>Loads a RocketPolicy model.</p>
<p>If <cite>ckpt_path</cite> is provided, it loads the model from the checkpoint.
Otherwise, it loads a pre-trained model from Hugging Face Hub.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ckpt_path</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Path to a .ckpt model checkpoint file. Defaults to None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The loaded RocketPolicy model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#minestudio.models.rocket_one.body.RocketPolicy" title="minestudio.models.rocket_one.body.RocketPolicy">RocketPolicy</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-minestudio.models.steve_one.body">
<span id="steveone"></span><h2>SteveOne<a class="headerlink" href="#module-minestudio.models.steve_one.body" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="minestudio.models.steve_one.body.ImgObsProcess">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.models.steve_one.body.</span></span><span class="sig-name descname"><span class="pre">ImgObsProcess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cnn_outsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_init_norm_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_norm_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/steve_one/body.html#ImgObsProcess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.steve_one.body.ImgObsProcess" title="Link to this definition">#</a></dt>
<dd><p>Image observation processing using ImpalaCNN followed by a linear layer.</p>
<p>Processes image observations through an Impala CNN architecture and then
applies a linear transformation to produce the final output embeddings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cnn_outsize</strong> – Output dimension of the Impala CNN</p></li>
<li><p><strong>output_size</strong> – Output size of the final linear layer</p></li>
<li><p><strong>dense_init_norm_kwargs</strong> – Initialization kwargs for linear FanInInitReLULayer</p></li>
<li><p><strong>init_norm_kwargs</strong> – Initialization kwargs for 2D and 3D conv FanInInitReLULayer</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.steve_one.body.ImgObsProcess.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/steve_one/body.html#ImgObsProcess.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.steve_one.body.ImgObsProcess.forward" title="Link to this definition">#</a></dt>
<dd><p>Process image through CNN and linear transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>img</strong> – Input image tensor of shape (B, C, H, W)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Processed image features of shape (B, output_size)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="minestudio.models.steve_one.body.ImgPreprocessing">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.models.steve_one.body.</span></span><span class="sig-name descname"><span class="pre">ImgPreprocessing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_statistics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/steve_one/body.html#ImgPreprocessing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.steve_one.body.ImgPreprocessing" title="Link to this definition">#</a></dt>
<dd><p>Image preprocessing module for normalization and scaling.</p>
<p>Normalizes incoming images using either provided statistics (mean/std) or
simple scaling. Supports both statistical normalization from pre-computed
statistics and basic scaling by a constant factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_statistics</strong> – Path to npz file containing mean and std statistics.
If specified, normalize images using these statistics.</p></li>
<li><p><strong>scale_img</strong> – If True and img_statistics not specified, scale images by 1/255.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.steve_one.body.ImgPreprocessing.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/steve_one/body.html#ImgPreprocessing.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.steve_one.body.ImgPreprocessing.forward" title="Link to this definition">#</a></dt>
<dd><p>Apply preprocessing normalization to input images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>img</strong> – Input image tensor of shape (B, C, H, W) or (B, T, C, H, W)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized image tensor with same shape as input</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="minestudio.models.steve_one.body.MinecraftPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.models.steve_one.body.</span></span><span class="sig-name descname"><span class="pre">MinecraftPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recurrence_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lstm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impala_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impala_chans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(16,</span> <span class="pre">32,</span> <span class="pre">32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_processing_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">single_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_input_img</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_img_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_norm_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impala_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_reward_monitors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_statistics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_conv_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_mlp_embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_mask_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'clipped_causal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_memory_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2048</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_pointwise_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointwise_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointwise_use_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_recurrence_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recurrence_is_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_pre_lstm_ln</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mineclip_embed_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">unused_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/steve_one/body.html#MinecraftPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.steve_one.body.MinecraftPolicy" title="Link to this definition">#</a></dt>
<dd><p>Neural network policy for Minecraft gameplay with multimodal inputs.</p>
<p>This policy combines visual and textual information processing through CNN and
recurrent architectures. It supports various recurrence types including LSTM,
masked LSTM, and transformer variants for sequential decision making.</p>
<p>The architecture processes images through ImpalaCNN, combines with MineCLIP
embeddings for text conditioning, and uses recurrent layers for temporal modeling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>recurrence_type</strong> – Type of recurrent architecture:
- ‘multi_layer_lstm’: Multi-layer LSTM (no ragged batching support)
- ‘multi_layer_bilstm’: Bidirectional multi-layer LSTM
- ‘multi_masked_lstm’: Multi-layer LSTM with ragged batching support
- ‘transformer’: Dense transformer architecture
- ‘none’: No recurrence</p></li>
<li><p><strong>init_norm_kwargs</strong> – Initialization kwargs for all FanInInitReLULayers</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.steve_one.body.MinecraftPolicy.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ob</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/steve_one/body.html#MinecraftPolicy.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.steve_one.body.MinecraftPolicy.forward" title="Link to this definition">#</a></dt>
<dd><p>Forward pass through the Minecraft policy network.</p>
<p>Processes multimodal observations (images and MineCLIP embeddings) through
CNN and recurrent layers to produce policy and value latent representations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ob</strong> – Observation dictionary containing ‘img’ and ‘mineclip_embed’ keys</p></li>
<li><p><strong>state_in</strong> – Input recurrent state from previous timestep</p></li>
<li><p><strong>context</strong> – Context dictionary containing ‘first’ episode flags</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of ((pi_latent, vf_latent), state_out) where latents are
policy and value representations and state_out is updated recurrent state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.steve_one.body.MinecraftPolicy.initial_state">
<span class="sig-name descname"><span class="pre">initial_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batchsize</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/steve_one/body.html#MinecraftPolicy.initial_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.steve_one.body.MinecraftPolicy.initial_state" title="Link to this definition">#</a></dt>
<dd><p>Initialize the recurrent state for a new episode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batchsize</strong> – Batch size for state initialization</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Initial recurrent state tensors or None if no recurrence</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.steve_one.body.MinecraftPolicy.output_latent_size">
<span class="sig-name descname"><span class="pre">output_latent_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/steve_one/body.html#MinecraftPolicy.output_latent_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.steve_one.body.MinecraftPolicy.output_latent_size" title="Link to this definition">#</a></dt>
<dd><p>Get the size of the output latent representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Integer size of the hidden/latent dimension</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="minestudio.models.steve_one.body.SteveOnePolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.models.steve_one.body.</span></span><span class="sig-name descname"><span class="pre">SteveOnePolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/steve_one/body.html#SteveOnePolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.steve_one.body.SteveOnePolicy" title="Link to this definition">#</a></dt>
<dd><p>Complete STEVE-1 policy combining visual processing, text conditioning, and action prediction.</p>
<p>This policy integrates MineCLIP for multimodal understanding, a TranslatorVAE for
text-to-visual translation, and a MinecraftPolicy network for decision making.
It supports both text and video conditioning through classifier-free guidance.</p>
<p>The architecture enables text-conditioned gameplay by translating textual instructions
into visual embeddings that guide the policy’s behavior in Minecraft environments.</p>
<dl class="py property">
<dt class="sig sig-object py" id="minestudio.models.steve_one.body.SteveOnePolicy.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">device</span></em><a class="headerlink" href="#minestudio.models.steve_one.body.SteveOnePolicy.device" title="Link to this definition">#</a></dt>
<dd><p>Get the device of the policy model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.device where the model parameters are located</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.steve_one.body.SteveOnePolicy.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/minestudio/models/steve_one/body.html#SteveOnePolicy.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.steve_one.body.SteveOnePolicy.forward" title="Link to this definition">#</a></dt>
<dd><p>Forward pass with classifier-free guidance for conditioned generation.</p>
<p>Performs a forward pass through the policy network with optional classifier-free
guidance. When cond_scale &gt; 0, runs both conditioned and unconditioned inference
and combines the outputs using the specified guidance scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>condition</strong> – Dictionary with ‘cond_scale’ and ‘mineclip_embeds’</p></li>
<li><p><strong>input</strong> – Dictionary with ‘image’ key containing observation images</p></li>
<li><p><strong>state_in</strong> – Optional list of recurrent state tensors from previous timestep</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments (unused)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of (latents_dict, state_out) where latents_dict contains
‘pi_logits’ and ‘vpred’ and state_out is updated recurrent state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.steve_one.body.SteveOnePolicy.initial_state">
<span class="sig-name descname"><span class="pre">initial_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/minestudio/models/steve_one/body.html#SteveOnePolicy.initial_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.steve_one.body.SteveOnePolicy.initial_state" title="Link to this definition">#</a></dt>
<dd><p>Initialize recurrent state for policy inference.</p>
<p>Creates initial state tensors for the recurrent layers. When classifier-free
guidance is enabled (cond_scale &gt; 0), duplicates states for both conditioned
and unconditioned inference branches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>condition</strong> – Conditioning dictionary with ‘cond_scale’ key</p></li>
<li><p><strong>batch_size</strong> – Batch size for state initialization</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of initial state tensors</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.steve_one.body.SteveOnePolicy.merge_state">
<span class="sig-name descname"><span class="pre">merge_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">states</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/minestudio/models/steve_one/body.html#SteveOnePolicy.merge_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.steve_one.body.SteveOnePolicy.merge_state" title="Link to this definition">#</a></dt>
<dd><p>Abstract method to merge multiple states.</p>
<p>Subclasses should implement this if they support merging states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>states</strong> – The states to merge.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The merged state as an optional list of tensors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[List[torch.Tensor]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – if not implemented by the subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.steve_one.body.SteveOnePolicy.prepare_condition">
<span class="sig-name descname"><span class="pre">prepare_condition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instruction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/minestudio/models/steve_one/body.html#SteveOnePolicy.prepare_condition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.steve_one.body.SteveOnePolicy.prepare_condition" title="Link to this definition">#</a></dt>
<dd><p>Prepare conditioning information from text or video instructions.</p>
<p>Processes either text instructions (via TranslatorVAE) or video demonstrations
(via direct MineCLIP encoding) to create conditioning embeddings for the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>instruction</strong> – Dictionary containing either ‘text’ or ‘video’ key plus ‘cond_scale’</p></li>
<li><p><strong>deterministic</strong> – Whether to use deterministic sampling for text conditioning</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary with ‘cond_scale’ and ‘mineclip_embeds’ for policy conditioning</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>AssertionError</strong> – If instruction lacks required keys or has conflicting modalities</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.steve_one.body.SteveOnePolicy.reset_parameters">
<span class="sig-name descname"><span class="pre">reset_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/steve_one/body.html#SteveOnePolicy.reset_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.steve_one.body.SteveOnePolicy.reset_parameters" title="Link to this definition">#</a></dt>
<dd><p>Reset all trainable parameters in the policy network.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – This method is not yet implemented</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.steve_one.body.SteveOnePolicy.split_state">
<span class="sig-name descname"><span class="pre">split_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_num</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/minestudio/models/steve_one/body.html#SteveOnePolicy.split_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.steve_one.body.SteveOnePolicy.split_state" title="Link to this definition">#</a></dt>
<dd><p>Abstract method to split a state into multiple states.</p>
<p>Subclasses should implement this if they support splitting states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – The state to split.</p></li>
<li><p><strong>split_num</strong> – The number of ways to split the state.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An optional list of split states.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[List[List[torch.Tensor]]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – if not implemented by the subclass.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="minestudio.models.steve_one.body.TranslatorVAE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.models.steve_one.body.</span></span><span class="sig-name descname"><span class="pre">TranslatorVAE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/steve_one/body.html#TranslatorVAE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.steve_one.body.TranslatorVAE" title="Link to this definition">#</a></dt>
<dd><p>Variational Autoencoder for translating between text and visual embeddings.</p>
<p>This VAE learns to map text embeddings to visual embeddings through a latent space,
enabling text-to-visual translation for multimodal learning tasks. The encoder
takes concatenated visual and text embeddings to produce latent representations,
while the decoder reconstructs visual embeddings from latent codes and text.</p>
<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.steve_one.body.TranslatorVAE.decode">
<span class="sig-name descname"><span class="pre">decode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latent_vector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_embeddings</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/steve_one/body.html#TranslatorVAE.decode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.steve_one.body.TranslatorVAE.decode" title="Link to this definition">#</a></dt>
<dd><p>Decode latent vector and text embeddings into visual embeddings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latent_vector</strong> – Latent representation tensor of shape (B, latent_dim)</p></li>
<li><p><strong>text_embeddings</strong> – Text embedding tensor of shape (B, input_dim)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reconstructed visual embeddings of shape (B, input_dim)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.steve_one.body.TranslatorVAE.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">visual_embeddings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_embeddings</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/steve_one/body.html#TranslatorVAE.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.steve_one.body.TranslatorVAE.encode" title="Link to this definition">#</a></dt>
<dd><p>Encode concatenated visual and text embeddings into latent parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>visual_embeddings</strong> – Visual embedding tensor of shape (B, input_dim)</p></li>
<li><p><strong>text_embeddings</strong> – Text embedding tensor of shape (B, input_dim)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Encoded tensor containing mean and log variance (B, 2*latent_dim)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.steve_one.body.TranslatorVAE.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text_embeddings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/steve_one/body.html#TranslatorVAE.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.steve_one.body.TranslatorVAE.forward" title="Link to this definition">#</a></dt>
<dd><p>Generate visual embeddings from text embeddings using prior distribution.</p>
<p>Uses a zero-mean, unit-variance prior to sample latent vectors and decode
them into visual embeddings conditioned on the input text embeddings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text_embeddings</strong> – Input text embeddings of shape (B, input_dim)</p></li>
<li><p><strong>deterministic</strong> – If True, use mean of prior; if False, sample from prior</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generated visual embeddings of shape (B, input_dim)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.steve_one.body.TranslatorVAE.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logvar</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/steve_one/body.html#TranslatorVAE.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.steve_one.body.TranslatorVAE.sample" title="Link to this definition">#</a></dt>
<dd><p>Sample a latent vector using the reparameterization trick.</p>
<p>Applies the reparameterization trick to sample from a Gaussian distribution
defined by mu and logvar, enabling backpropagation through stochastic sampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> – Mean tensor of shape (B, latent_dim)</p></li>
<li><p><strong>logvar</strong> – Log variance tensor of shape (B, latent_dim)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sampled latent vector of shape (B, latent_dim)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="minestudio.models.steve_one.body.load_steve_one_policy">
<span class="sig-prename descclassname"><span class="pre">minestudio.models.steve_one.body.</span></span><span class="sig-name descname"><span class="pre">load_steve_one_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpt_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#minestudio.models.steve_one.body.SteveOnePolicy" title="minestudio.models.steve_one.body.SteveOnePolicy"><span class="pre">SteveOnePolicy</span></a></span></span><a class="reference internal" href="../../_modules/minestudio/models/steve_one/body.html#load_steve_one_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.steve_one.body.load_steve_one_policy" title="Link to this definition">#</a></dt>
<dd><p>Load a pre-trained STEVE-1 policy from a checkpoint path.</p>
<p>Convenience function to load a STEVE-1 policy using the HuggingFace Hub
model loading mechanism.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ckpt_path</strong> – Path or HuggingFace model identifier for the checkpoint</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loaded SteveOnePolicy instance</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-minestudio.models.vpt.body">
<span id="vpt"></span><h2>VPT<a class="headerlink" href="#module-minestudio.models.vpt.body" title="Link to this heading">#</a></h2>
<p>Date: 2024-11-11 20:54:15
LastEditors: muzhancun <a class="reference external" href="mailto:muzhancun&#37;&#52;&#48;stu&#46;pku&#46;edu&#46;cn">muzhancun<span>&#64;</span>stu<span>&#46;</span>pku<span>&#46;</span>edu<span>&#46;</span>cn</a>
LastEditTime: 2025-05-28 14:29:56
FilePath: /MineStudio/minestudio/models/vpt/body.py</p>
<dl class="py class">
<dt class="sig sig-object py" id="minestudio.models.vpt.body.ImgObsProcess">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.models.vpt.body.</span></span><span class="sig-name descname"><span class="pre">ImgObsProcess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cnn_outsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_init_norm_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_norm_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/vpt/body.html#ImgObsProcess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.vpt.body.ImgObsProcess" title="Link to this definition">#</a></dt>
<dd><p>ImpalaCNN followed by a linear layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cnn_outsize</strong> – impala output dimension</p></li>
<li><p><strong>output_size</strong> – output size of the linear layer.</p></li>
<li><p><strong>dense_init_norm_kwargs</strong> – kwargs for linear FanInInitReLULayer</p></li>
<li><p><strong>init_norm_kwargs</strong> – kwargs for 2d and 3d conv FanInInitReLULayer</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.vpt.body.ImgObsProcess.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/vpt/body.html#ImgObsProcess.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.vpt.body.ImgObsProcess.forward" title="Link to this definition">#</a></dt>
<dd><p>Process the image observation.</p>
<p>Passes the image through the ImpalaCNN and then a linear layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>img</strong> (<em>torch.Tensor</em>) – The input image tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed image features.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="minestudio.models.vpt.body.ImgPreprocessing">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.models.vpt.body.</span></span><span class="sig-name descname"><span class="pre">ImgPreprocessing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_statistics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/vpt/body.html#ImgPreprocessing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.vpt.body.ImgPreprocessing" title="Link to this definition">#</a></dt>
<dd><p>Normalize incoming images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_statistics</strong> – remote path to npz file with a mean and std image. If specified
normalize images using this.</p></li>
<li><p><strong>scale_img</strong> – If true and img_statistics not specified, scale incoming images by 1/255.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.vpt.body.ImgPreprocessing.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/vpt/body.html#ImgPreprocessing.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.vpt.body.ImgPreprocessing.forward" title="Link to this definition">#</a></dt>
<dd><p>Apply image preprocessing.</p>
<p>Normalizes the input image tensor. If <cite>img_statistics</cite> was provided during
initialization, it uses the mean and std from the file. Otherwise, it scales
the image by <cite>1.0 / self.ob_scale</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>img</strong> (<em>torch.Tensor</em>) – The input image tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The preprocessed image tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="minestudio.models.vpt.body.MinecraftPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.models.vpt.body.</span></span><span class="sig-name descname"><span class="pre">MinecraftPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recurrence_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'transformer'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impala_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impala_chans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(16,</span> <span class="pre">32,</span> <span class="pre">32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_processing_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">single_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_input_img</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_img_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_norm_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impala_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_reward_monitors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_statistics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_conv_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_mlp_embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_mask_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'clipped_causal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_memory_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2048</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_pointwise_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointwise_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointwise_use_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_recurrence_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recurrence_is_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_pre_lstm_ln</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">unused_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/vpt/body.html#MinecraftPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.vpt.body.MinecraftPolicy" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>recurrence_type</strong> – <p>None                - No recurrence, adds no extra layers
lstm                - (Depreciated). Singular LSTM
multi_layer_lstm    - Multi-layer LSTM. Uses n_recurrence_layers to determine number of consecututive LSTMs</p>
<blockquote>
<div><p>Does NOT support ragged batching</p>
</div></blockquote>
<dl class="simple">
<dt>multi_masked_lstm   - Multi-layer LSTM that supports ragged batching via the first vector. This model is slower</dt><dd><p>Uses n_recurrence_layers to determine number of consecututive LSTMs</p>
</dd>
</dl>
<p>transformer         - Dense transformer</p>
</p></li>
<li><p><strong>init_norm_kwargs</strong> – kwargs for all FanInInitReLULayers.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.vpt.body.MinecraftPolicy.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ob</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/vpt/body.html#MinecraftPolicy.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.vpt.body.MinecraftPolicy.forward" title="Link to this definition">#</a></dt>
<dd><p>Forward pass of the MinecraftPolicy.</p>
<p>Processes image observations, passes them through recurrent layers, and produces
latent representations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ob</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em>) – Dictionary of observations, expected to contain “image”.</p></li>
<li><p><strong>state_in</strong> (<em>Any # Type depends on recurrence_type</em>) – Input recurrent state.</p></li>
<li><p><strong>context</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em>) – Context dictionary, expected to contain “first” (a tensor indicating episode starts).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple containing:
- pi_latent_or_tuple (Union[torch.Tensor, Tuple[torch.Tensor, torch.Tensor]]):</p>
<blockquote>
<div><p>If <cite>single_output</cite> is True, this is a single tensor for both policy and value.
Otherwise, it’s a tuple (pi_latent, vf_latent).</p>
</div></blockquote>
<ul class="simple">
<li><p>state_out (Any): Output recurrent state.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[Union[torch.Tensor, Tuple[torch.Tensor, torch.Tensor]], Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.vpt.body.MinecraftPolicy.initial_state">
<span class="sig-name descname"><span class="pre">initial_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batchsize</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/vpt/body.html#MinecraftPolicy.initial_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.vpt.body.MinecraftPolicy.initial_state" title="Link to this definition">#</a></dt>
<dd><p>Get the initial recurrent state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batchsize</strong> (<em>int</em>) – The batch size for the initial state.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The initial recurrent state, or None if no recurrent layer is used.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any # Type depends on recurrence_type, can be None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.vpt.body.MinecraftPolicy.output_latent_size">
<span class="sig-name descname"><span class="pre">output_latent_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/vpt/body.html#MinecraftPolicy.output_latent_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.vpt.body.MinecraftPolicy.output_latent_size" title="Link to this definition">#</a></dt>
<dd><p>Returns the size of the output latent vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The hidden size, which is the dimension of the output latents.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="minestudio.models.vpt.body.VPTPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minestudio.models.vpt.body.</span></span><span class="sig-name descname"><span class="pre">VPTPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/vpt/body.html#VPTPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.vpt.body.VPTPolicy" title="Link to this definition">#</a></dt>
<dd><p>VPT (Video PreTraining) Policy.</p>
<p>This class wraps the <cite>MinecraftPolicy</cite> network and integrates it with the <cite>MinePolicy</cite>
base class, providing methods for action selection, initial state, and state/input
merging/splitting for batched online inference. It also supports loading from
Hugging Face Hub.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>policy_kwargs</strong> (<em>Dict</em>) – Keyword arguments to initialize the <cite>MinecraftPolicy</cite> (self.net).</p></li>
<li><p><strong>action_space</strong> (<em>Optional</em><em>[</em><em>gymnasium.spaces.Space</em><em>]</em>) – The action space of the environment. Passed to <cite>MinePolicy</cite> constructor.
Defaults to None.</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments passed to the <cite>MinePolicy</cite> constructor (e.g., temperature).</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.vpt.body.VPTPolicy.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_in</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/vpt/body.html#VPTPolicy.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.vpt.body.VPTPolicy.forward" title="Link to this definition">#</a></dt>
<dd><p>Forward pass of the VPTPolicy.</p>
<p>Takes observations and recurrent state, passes them through the underlying
<cite>MinecraftPolicy</cite> network, and then through policy and value heads.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em>) – Dictionary of input observations, expected to contain “image”.
The “image” tensor should have shape (B, T, H, W, C) or similar.</p></li>
<li><p><strong>state_in</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>torch.Tensor</em><em>]</em><em>]</em>) – Input recurrent state. If None, an initial state is generated.</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments (not directly used in this method but part of signature).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing:
- latents (Dict[str, torch.Tensor]): Dictionary with ‘pi_logits’ and ‘vpred’.
- state_out (List[torch.Tensor]): Output recurrent state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[Dict[str, torch.Tensor], List[torch.Tensor]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.vpt.body.VPTPolicy.initial_state">
<span class="sig-name descname"><span class="pre">initial_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/vpt/body.html#VPTPolicy.initial_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.vpt.body.VPTPolicy.initial_state" title="Link to this definition">#</a></dt>
<dd><p>Get the initial recurrent state for a given batch size.</p>
<p>Caches initial states for frequently used batch sizes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch_size</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – The batch size. If None, returns state for batch size 1 (squeezed).
Defaults to None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of initial state tensors for the recurrent network, moved to the correct device.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.vpt.body.VPTPolicy.merge_input">
<span class="sig-name descname"><span class="pre">merge_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tensor</span></span></span><a class="reference internal" href="../../_modules/minestudio/models/vpt/body.html#VPTPolicy.merge_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.vpt.body.VPTPolicy.merge_input" title="Link to this definition">#</a></dt>
<dd><p>Merge a list of individual inputs into a single batched input tensor.</p>
<p>Handles inputs where “image” is 3D (single frame) or 4D (already batched/sequence).
All inputs are moved to the policy’s device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong> (<em>List</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>] </em><em># Values are typically np.ndarray</em><em> or </em><em>torch.Tensor</em>) – A list of input dictionaries, each expected to have an “image” key.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A batched input dictionary with “image” as a torch.Tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.vpt.body.VPTPolicy.merge_state">
<span class="sig-name descname"><span class="pre">merge_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">states</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/minestudio/models/vpt/body.html#VPTPolicy.merge_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.vpt.body.VPTPolicy.merge_state" title="Link to this definition">#</a></dt>
<dd><p>Merge a list of individual recurrent states into a single batched state.</p>
<p>Concatenates corresponding state tensors along the batch dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>states</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>torch.Tensor</em><em>]</em><em>]</em>) – A list of recurrent states. Each state is a list of tensors.
Example: <cite>[[s1_env1, s2_env1, …], [s1_env2, s2_env2, …], …]</cite></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The batched recurrent state, where each tensor is a concatenation of
the corresponding tensors from the input states.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[List[torch.Tensor]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minestudio.models.vpt.body.VPTPolicy.split_state">
<span class="sig-name descname"><span class="pre">split_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_num</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/minestudio/models/vpt/body.html#VPTPolicy.split_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.vpt.body.VPTPolicy.split_state" title="Link to this definition">#</a></dt>
<dd><p>Split a batched recurrent state into a list of individual states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>states</strong> (<em>List</em><em>[</em><em>torch.Tensor</em><em>]</em>) – The batched recurrent state (a list of tensors, where the first
dimension of each tensor is the batch size).</p></li>
<li><p><strong>split_num</strong> (<em>int</em>) – The number of individual states to split into (should match batch size).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of individual recurrent states. Each state in the list corresponds
to one item from the original batch.
Example: <cite>[[s1_item1, s2_item1, …], [s1_item2, s2_item2, …], …]</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[List[List[torch.Tensor]]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="minestudio.models.vpt.body.load_vpt_policy">
<span class="sig-prename descclassname"><span class="pre">minestudio.models.vpt.body.</span></span><span class="sig-name descname"><span class="pre">load_vpt_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/minestudio/models/vpt/body.html#load_vpt_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.vpt.body.load_vpt_policy" title="Link to this definition">#</a></dt>
<dd><p>Load a VPTPolicy model.</p>
<p>Can load from a local pickle file and optionally apply weights from a .ckpt file,
or load a pretrained model from Hugging Face Hub if <cite>model_path</cite> is None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_path</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Path to the .model pickle file containing policy configuration.
If None, attempts to load from Hugging Face Hub.</p></li>
<li><p><strong>weights_path</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Path to the .ckpt file containing model weights.
If None, weights are not loaded separately (e.g., if part of .model or Hub model).
Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <cite>model_path</cite> is None and <cite>ckpt_path</cite> (internal, seems like a typo for <cite>weights_path</cite>
in the original conditional logic, but <cite>repo_id</cite> is used if <cite>weights_path</cite> is also None)
is also None, and no default repo_id is hit.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The loaded VPTPolicy model.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#minestudio.models.vpt.body.VPTPolicy" title="minestudio.models.vpt.body.VPTPolicy">VPTPolicy</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="utils">
<h2>Utils<a class="headerlink" href="#utils" title="Link to this heading">#</a></h2>
<section id="module-minestudio.models.utils.download">
<span id="download"></span><h3>Download<a class="headerlink" href="#module-minestudio.models.utils.download" title="Link to this heading">#</a></h3>
<p>Date: 2024-12-14 01:46:36
LastEditors: muzhancun <a class="reference external" href="mailto:muzhancun&#37;&#52;&#48;126&#46;com">muzhancun<span>&#64;</span>126<span>&#46;</span>com</a>
LastEditTime: 2024-12-14 02:00:17
FilePath: /MineStudio/minestudio/models/utils/download.py</p>
<dl class="py function">
<dt class="sig sig-object py" id="minestudio.models.utils.download.download_model">
<span class="sig-prename descclassname"><span class="pre">minestudio.models.utils.download.</span></span><span class="sig-name descname"><span class="pre">download_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'downloads'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../_modules/minestudio/models/utils/download.html#download_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minestudio.models.utils.download.download_model" title="Link to this definition">#</a></dt>
<dd><p>Downloads a specified model from Hugging Face Hub if it doesn’t exist locally.</p>
<p>Prompts the user for confirmation before downloading. The model is saved to a
subdirectory within <cite>local_dir</cite> named after <cite>model_name</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_name</strong> (<em>str</em>) – The name of the model to download.
Valid names are “ROCKET-1”, “VPT”, “GROOT”, “STEVE-1”.</p></li>
<li><p><strong>local_dir</strong> (<em>str</em>) – The base directory to save downloaded models. Defaults to “downloads”.
This will be relative to the parent directory of this script’s location.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The local path to the downloaded model directory if successful or if download was skipped
by user choice but the directory was expected to exist (though it might not in that case).
Returns None if download is skipped and directory doesn’t exist, or if an error occurs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – if <cite>model_name</cite> is not one of the recognized names.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>

<div class="section ablog__blog_comments">
   
</div>

                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../data/index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Data API Documentation</p>
      </div>
    </a>
    <a class="right-next"
       href="../offline/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Offline API Documentation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-minestudio.models.base_policy">BasePolicy</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.base_policy.MinePolicy"><code class="docutils literal notranslate"><span class="pre">MinePolicy</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.base_policy.MinePolicy.device"><code class="docutils literal notranslate"><span class="pre">MinePolicy.device</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.base_policy.MinePolicy.forward"><code class="docutils literal notranslate"><span class="pre">MinePolicy.forward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.base_policy.MinePolicy.get_action"><code class="docutils literal notranslate"><span class="pre">MinePolicy.get_action()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.base_policy.MinePolicy.initial_state"><code class="docutils literal notranslate"><span class="pre">MinePolicy.initial_state()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.base_policy.MinePolicy.merge_input"><code class="docutils literal notranslate"><span class="pre">MinePolicy.merge_input()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.base_policy.MinePolicy.merge_state"><code class="docutils literal notranslate"><span class="pre">MinePolicy.merge_state()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.base_policy.MinePolicy.reset_parameters"><code class="docutils literal notranslate"><span class="pre">MinePolicy.reset_parameters()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.base_policy.MinePolicy.split_action"><code class="docutils literal notranslate"><span class="pre">MinePolicy.split_action()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.base_policy.MinePolicy.split_state"><code class="docutils literal notranslate"><span class="pre">MinePolicy.split_state()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.base_policy.dict_map"><code class="docutils literal notranslate"><span class="pre">dict_map()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.base_policy.recursive_tensor_op"><code class="docutils literal notranslate"><span class="pre">recursive_tensor_op()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-minestudio.utils.vpt_lib.action_head">Action Head</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.ActionHead"><code class="docutils literal notranslate"><span class="pre">ActionHead</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.ActionHead.entropy"><code class="docutils literal notranslate"><span class="pre">ActionHead.entropy()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.ActionHead.forward"><code class="docutils literal notranslate"><span class="pre">ActionHead.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.ActionHead.kl_divergence"><code class="docutils literal notranslate"><span class="pre">ActionHead.kl_divergence()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.ActionHead.logprob"><code class="docutils literal notranslate"><span class="pre">ActionHead.logprob()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.ActionHead.sample"><code class="docutils literal notranslate"><span class="pre">ActionHead.sample()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.CategoricalActionHead"><code class="docutils literal notranslate"><span class="pre">CategoricalActionHead</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.CategoricalActionHead.entropy"><code class="docutils literal notranslate"><span class="pre">CategoricalActionHead.entropy()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.CategoricalActionHead.forward"><code class="docutils literal notranslate"><span class="pre">CategoricalActionHead.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.CategoricalActionHead.kl_divergence"><code class="docutils literal notranslate"><span class="pre">CategoricalActionHead.kl_divergence()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.CategoricalActionHead.logprob"><code class="docutils literal notranslate"><span class="pre">CategoricalActionHead.logprob()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.CategoricalActionHead.nucleus_sample"><code class="docutils literal notranslate"><span class="pre">CategoricalActionHead.nucleus_sample()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.CategoricalActionHead.reset_parameters"><code class="docutils literal notranslate"><span class="pre">CategoricalActionHead.reset_parameters()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.CategoricalActionHead.sample"><code class="docutils literal notranslate"><span class="pre">CategoricalActionHead.sample()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.CategoricalActionHead.vanilla_sample"><code class="docutils literal notranslate"><span class="pre">CategoricalActionHead.vanilla_sample()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.DiagGaussianActionHead"><code class="docutils literal notranslate"><span class="pre">DiagGaussianActionHead</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.DiagGaussianActionHead.entropy"><code class="docutils literal notranslate"><span class="pre">DiagGaussianActionHead.entropy()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.DiagGaussianActionHead.forward"><code class="docutils literal notranslate"><span class="pre">DiagGaussianActionHead.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.DiagGaussianActionHead.kl_divergence"><code class="docutils literal notranslate"><span class="pre">DiagGaussianActionHead.kl_divergence()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.DiagGaussianActionHead.logprob"><code class="docutils literal notranslate"><span class="pre">DiagGaussianActionHead.logprob()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.DiagGaussianActionHead.reset_parameters"><code class="docutils literal notranslate"><span class="pre">DiagGaussianActionHead.reset_parameters()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.DiagGaussianActionHead.sample"><code class="docutils literal notranslate"><span class="pre">DiagGaussianActionHead.sample()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.DictActionHead"><code class="docutils literal notranslate"><span class="pre">DictActionHead</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.DictActionHead.entropy"><code class="docutils literal notranslate"><span class="pre">DictActionHead.entropy()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.DictActionHead.forward"><code class="docutils literal notranslate"><span class="pre">DictActionHead.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.DictActionHead.kl_divergence"><code class="docutils literal notranslate"><span class="pre">DictActionHead.kl_divergence()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.DictActionHead.logprob"><code class="docutils literal notranslate"><span class="pre">DictActionHead.logprob()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.DictActionHead.reset_parameters"><code class="docutils literal notranslate"><span class="pre">DictActionHead.reset_parameters()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.DictActionHead.sample"><code class="docutils literal notranslate"><span class="pre">DictActionHead.sample()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.MSEActionHead"><code class="docutils literal notranslate"><span class="pre">MSEActionHead</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.MSEActionHead.entropy"><code class="docutils literal notranslate"><span class="pre">MSEActionHead.entropy()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.MSEActionHead.forward"><code class="docutils literal notranslate"><span class="pre">MSEActionHead.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.MSEActionHead.kl_divergence"><code class="docutils literal notranslate"><span class="pre">MSEActionHead.kl_divergence()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.MSEActionHead.logprob"><code class="docutils literal notranslate"><span class="pre">MSEActionHead.logprob()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.MSEActionHead.reset_parameters"><code class="docutils literal notranslate"><span class="pre">MSEActionHead.reset_parameters()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.MSEActionHead.sample"><code class="docutils literal notranslate"><span class="pre">MSEActionHead.sample()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.TupleActionHead"><code class="docutils literal notranslate"><span class="pre">TupleActionHead</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.TupleActionHead.entropy"><code class="docutils literal notranslate"><span class="pre">TupleActionHead.entropy()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.TupleActionHead.forward"><code class="docutils literal notranslate"><span class="pre">TupleActionHead.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.TupleActionHead.kl_divergence"><code class="docutils literal notranslate"><span class="pre">TupleActionHead.kl_divergence()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.TupleActionHead.logprob"><code class="docutils literal notranslate"><span class="pre">TupleActionHead.logprob()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.TupleActionHead.reset_parameters"><code class="docutils literal notranslate"><span class="pre">TupleActionHead.reset_parameters()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.TupleActionHead.sample"><code class="docutils literal notranslate"><span class="pre">TupleActionHead.sample()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.fan_in_linear"><code class="docutils literal notranslate"><span class="pre">fan_in_linear()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.action_head.make_action_head"><code class="docutils literal notranslate"><span class="pre">make_action_head()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-minestudio.utils.vpt_lib.scaled_mse_head">Value Head</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.scaled_mse_head.ScaledMSEHead"><code class="docutils literal notranslate"><span class="pre">ScaledMSEHead</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.scaled_mse_head.ScaledMSEHead.denormalize"><code class="docutils literal notranslate"><span class="pre">ScaledMSEHead.denormalize()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.scaled_mse_head.ScaledMSEHead.forward"><code class="docutils literal notranslate"><span class="pre">ScaledMSEHead.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.scaled_mse_head.ScaledMSEHead.loss"><code class="docutils literal notranslate"><span class="pre">ScaledMSEHead.loss()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.scaled_mse_head.ScaledMSEHead.normalize"><code class="docutils literal notranslate"><span class="pre">ScaledMSEHead.normalize()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.utils.vpt_lib.scaled_mse_head.ScaledMSEHead.reset_parameters"><code class="docutils literal notranslate"><span class="pre">ScaledMSEHead.reset_parameters()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-minestudio.models.groot_one.body">GrootOne</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.groot_one.body.Decoder"><code class="docutils literal notranslate"><span class="pre">Decoder</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.groot_one.body.Decoder.forward"><code class="docutils literal notranslate"><span class="pre">Decoder.forward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.groot_one.body.Decoder.initial_state"><code class="docutils literal notranslate"><span class="pre">Decoder.initial_state()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.groot_one.body.GrootPolicy"><code class="docutils literal notranslate"><span class="pre">GrootPolicy</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.groot_one.body.GrootPolicy.encode_video"><code class="docutils literal notranslate"><span class="pre">GrootPolicy.encode_video()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.groot_one.body.GrootPolicy.forward"><code class="docutils literal notranslate"><span class="pre">GrootPolicy.forward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.groot_one.body.GrootPolicy.initial_state"><code class="docutils literal notranslate"><span class="pre">GrootPolicy.initial_state()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.groot_one.body.ImageEncoder"><code class="docutils literal notranslate"><span class="pre">ImageEncoder</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.groot_one.body.ImageEncoder.forward"><code class="docutils literal notranslate"><span class="pre">ImageEncoder.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.groot_one.body.LatentSpace"><code class="docutils literal notranslate"><span class="pre">LatentSpace</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.groot_one.body.LatentSpace.forward"><code class="docutils literal notranslate"><span class="pre">LatentSpace.forward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.groot_one.body.LatentSpace.sample"><code class="docutils literal notranslate"><span class="pre">LatentSpace.sample()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.groot_one.body.VideoEncoder"><code class="docutils literal notranslate"><span class="pre">VideoEncoder</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.groot_one.body.VideoEncoder.forward"><code class="docutils literal notranslate"><span class="pre">VideoEncoder.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.groot_one.body.load_groot_policy"><code class="docutils literal notranslate"><span class="pre">load_groot_policy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.groot_one.body.peel_off"><code class="docutils literal notranslate"><span class="pre">peel_off()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-minestudio.models.rocket_one.body">RocketOne</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.rocket_one.body.RocketPolicy"><code class="docutils literal notranslate"><span class="pre">RocketPolicy</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.rocket_one.body.RocketPolicy.forward"><code class="docutils literal notranslate"><span class="pre">RocketPolicy.forward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.rocket_one.body.RocketPolicy.initial_state"><code class="docutils literal notranslate"><span class="pre">RocketPolicy.initial_state()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.rocket_one.body.load_rocket_policy"><code class="docutils literal notranslate"><span class="pre">load_rocket_policy()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-minestudio.models.steve_one.body">SteveOne</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.steve_one.body.ImgObsProcess"><code class="docutils literal notranslate"><span class="pre">ImgObsProcess</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.steve_one.body.ImgObsProcess.forward"><code class="docutils literal notranslate"><span class="pre">ImgObsProcess.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.steve_one.body.ImgPreprocessing"><code class="docutils literal notranslate"><span class="pre">ImgPreprocessing</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.steve_one.body.ImgPreprocessing.forward"><code class="docutils literal notranslate"><span class="pre">ImgPreprocessing.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.steve_one.body.MinecraftPolicy"><code class="docutils literal notranslate"><span class="pre">MinecraftPolicy</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.steve_one.body.MinecraftPolicy.forward"><code class="docutils literal notranslate"><span class="pre">MinecraftPolicy.forward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.steve_one.body.MinecraftPolicy.initial_state"><code class="docutils literal notranslate"><span class="pre">MinecraftPolicy.initial_state()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.steve_one.body.MinecraftPolicy.output_latent_size"><code class="docutils literal notranslate"><span class="pre">MinecraftPolicy.output_latent_size()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.steve_one.body.SteveOnePolicy"><code class="docutils literal notranslate"><span class="pre">SteveOnePolicy</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.steve_one.body.SteveOnePolicy.device"><code class="docutils literal notranslate"><span class="pre">SteveOnePolicy.device</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.steve_one.body.SteveOnePolicy.forward"><code class="docutils literal notranslate"><span class="pre">SteveOnePolicy.forward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.steve_one.body.SteveOnePolicy.initial_state"><code class="docutils literal notranslate"><span class="pre">SteveOnePolicy.initial_state()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.steve_one.body.SteveOnePolicy.merge_state"><code class="docutils literal notranslate"><span class="pre">SteveOnePolicy.merge_state()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.steve_one.body.SteveOnePolicy.prepare_condition"><code class="docutils literal notranslate"><span class="pre">SteveOnePolicy.prepare_condition()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.steve_one.body.SteveOnePolicy.reset_parameters"><code class="docutils literal notranslate"><span class="pre">SteveOnePolicy.reset_parameters()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.steve_one.body.SteveOnePolicy.split_state"><code class="docutils literal notranslate"><span class="pre">SteveOnePolicy.split_state()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.steve_one.body.TranslatorVAE"><code class="docutils literal notranslate"><span class="pre">TranslatorVAE</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.steve_one.body.TranslatorVAE.decode"><code class="docutils literal notranslate"><span class="pre">TranslatorVAE.decode()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.steve_one.body.TranslatorVAE.encode"><code class="docutils literal notranslate"><span class="pre">TranslatorVAE.encode()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.steve_one.body.TranslatorVAE.forward"><code class="docutils literal notranslate"><span class="pre">TranslatorVAE.forward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.steve_one.body.TranslatorVAE.sample"><code class="docutils literal notranslate"><span class="pre">TranslatorVAE.sample()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.steve_one.body.load_steve_one_policy"><code class="docutils literal notranslate"><span class="pre">load_steve_one_policy()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-minestudio.models.vpt.body">VPT</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.vpt.body.ImgObsProcess"><code class="docutils literal notranslate"><span class="pre">ImgObsProcess</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.vpt.body.ImgObsProcess.forward"><code class="docutils literal notranslate"><span class="pre">ImgObsProcess.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.vpt.body.ImgPreprocessing"><code class="docutils literal notranslate"><span class="pre">ImgPreprocessing</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.vpt.body.ImgPreprocessing.forward"><code class="docutils literal notranslate"><span class="pre">ImgPreprocessing.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.vpt.body.MinecraftPolicy"><code class="docutils literal notranslate"><span class="pre">MinecraftPolicy</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.vpt.body.MinecraftPolicy.forward"><code class="docutils literal notranslate"><span class="pre">MinecraftPolicy.forward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.vpt.body.MinecraftPolicy.initial_state"><code class="docutils literal notranslate"><span class="pre">MinecraftPolicy.initial_state()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.vpt.body.MinecraftPolicy.output_latent_size"><code class="docutils literal notranslate"><span class="pre">MinecraftPolicy.output_latent_size()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.vpt.body.VPTPolicy"><code class="docutils literal notranslate"><span class="pre">VPTPolicy</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.vpt.body.VPTPolicy.forward"><code class="docutils literal notranslate"><span class="pre">VPTPolicy.forward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.vpt.body.VPTPolicy.initial_state"><code class="docutils literal notranslate"><span class="pre">VPTPolicy.initial_state()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.vpt.body.VPTPolicy.merge_input"><code class="docutils literal notranslate"><span class="pre">VPTPolicy.merge_input()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.vpt.body.VPTPolicy.merge_state"><code class="docutils literal notranslate"><span class="pre">VPTPolicy.merge_state()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.vpt.body.VPTPolicy.split_state"><code class="docutils literal notranslate"><span class="pre">VPTPolicy.split_state()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.vpt.body.load_vpt_policy"><code class="docutils literal notranslate"><span class="pre">load_vpt_policy()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#utils">Utils</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-minestudio.models.utils.download">Download</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minestudio.models.utils.download.download_model"><code class="docutils literal notranslate"><span class="pre">download_model()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/api/models/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, The CraftJarvis Team.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>