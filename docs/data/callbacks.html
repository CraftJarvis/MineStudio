
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Data Processing Callbacks &#8212; MineStudio</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=f44ad8c8" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=cb7bf70b"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'data/callbacks';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://craftjarvis.github.io/MineStudio/_static/version.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'latest';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>
    <link rel="icon" href="../_static/logo-no-text-light.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Models" href="../models/index.html" />
    <link rel="prev" title="Data Conversion" href="convertion.html" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />   
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo-no-text-light.svg" class="logo__image only-light" alt=""/>
    <img src="../_static/logo-no-text-light.svg" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">MineStudio</p>
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../overview/index.html">
    Overview
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../overview/getting-started.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../simulator/index.html">
    Simulator
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="index.html">
    Data
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../models/index.html">
    Models
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../offline/index.html">
    Offline
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../online/index.html">
    Online
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../inference/index.html">
    Inference
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../benchmark/index.html">
    Benchmark
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../api/index.html">
    API
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/CraftJarvis/MineStudio" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/minestudio" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-pypi fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://arxiv.org/pdf/2310.08235" title="ArXiv" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="ai ai-arxiv fa-lg" aria-hidden="true"></i>
            <span class="sr-only">ArXiv</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
          
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../overview/index.html">
    Overview
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../overview/getting-started.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../simulator/index.html">
    Simulator
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="index.html">
    Data
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../models/index.html">
    Models
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../offline/index.html">
    Offline
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../online/index.html">
    Online
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../inference/index.html">
    Inference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../benchmark/index.html">
    Benchmark
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/CraftJarvis/MineStudio" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/minestudio" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-pypi fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://arxiv.org/pdf/2310.08235" title="ArXiv" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="ai ai-arxiv fa-lg" aria-hidden="true"></i>
            <span class="sr-only">ArXiv</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../overview/installation.html">Installation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MineStudio Libraries</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../simulator/index.html">Simulator</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../simulator/general-information.html">General Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simulator/design-principles.html">Design Principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simulator/play.html">Graphical User Interfaces</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Data</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="dataset-raw.html">Raw Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataset-event.html">Event Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="convertion.html">Data Conversion</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Data Processing Callbacks</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../models/index.html">Models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../models/baseline-vpt.html">Built-in Models: VPT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/baseline-steve1.html">Built-in Models: STEVE-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/baseline-groot.html">Built-in Models: GROOT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/baseline-rocket1.html">Built-in Models: ROCKET-1</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../offline/index.html">Offline Training</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../offline/tutorial-vpt.html">Tutorial: Fine-tuning VPT to a Hunter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../offline/tutorial-rocket.html">Tutorial: Pre-Training ROCKET-1 from Scratch</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../online/index.html">Online Training</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../online/general-information.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../online/config.html">Config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../online/trainer.html">Trainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../online/rollout.html">Rollout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../online/customization.html">Customize</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../inference/index.html">Inference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../inference/baseline-vpt.html">Tutorial: Inference with VPT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../inference/baseline-steve1.html">Tutorial: Inference with STEVE-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../inference/baseline-groot.html">Tutorial: Inference with GROOT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../inference/baseline-rocket1.html">Tutorial: Inference with ROCKET-1</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../benchmark/index.html">Benchmark</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../benchmark/quick-benchmark.html">Quick benchmark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmark/automatic-evaluation.html">Automatic Evaluation Pipeline</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../overview/index.html" class="nav-link">Overview</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Data</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Data Processing Callbacks</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                   <!--
 * @Date: 2025-05-28 00:30:54
 * @LastEditors: caishaofei-mus1 1744260356@qq.com
 * @LastEditTime: 2025-05-28 00:44:54
 * @FilePath: /MineStudio/docs/source/data/callbacks.md
-->
<section id="data-processing-callbacks">
<h1>Data Processing Callbacks<a class="headerlink" href="#data-processing-callbacks" title="Link to this heading">#</a></h1>
<p>MineStudio employs a flexible callback mechanism to handle the loading, conversion, and visualization of data across different modalities. This design aims to achieve separation of concerns, decoupling data processing logic from the core data loading framework. Users can easily extend the system’s functionality for custom raw data formats or new data modalities by implementing specific callback classes, without needing to modify the core code.</p>
<section id="design-philosophy">
<h2>1. Design Philosophy<a class="headerlink" href="#design-philosophy" title="Link to this heading">#</a></h2>
<p>The core advantages of the callback mechanism are:</p>
<ul class="simple">
<li><p><strong>Decoupling</strong>: Separates the processing logic for specific modalities (e.g., decoding, transformation, augmentation, visualization) from generic data loaders (<code class="docutils literal notranslate"><span class="pre">RawDataset</span></code>, <code class="docutils literal notranslate"><span class="pre">EventDataset</span></code>) and data conversion tools (<code class="docutils literal notranslate"><span class="pre">ConvertManager</span></code>). This makes the core framework more versatile and stable.</p></li>
<li><p><strong>Extensibility</strong>: Users can easily add support for new data modalities or custom data formats by simply implementing the corresponding callback interfaces.</p></li>
<li><p><strong>Customizability</strong>: Users can tailor the processing of existing modalities to their specific needs, such as modifying data augmentation pipelines, changing how visual information is presented, or adjusting the details of data conversion.</p></li>
<li><p><strong>Code Reusability</strong>: Common callback logic (like LMDB reading/writing) can be implemented in base classes, while specific modality callbacks focus on their unique processing tasks.</p></li>
</ul>
<p>MineStudio defines three main base callback classes, serving runtime data loading, raw data format conversion, and data visualization respectively:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ModalKernelCallback</span></code>: Defines how to process specific modality data read from LMDB during data loading (e.g., within a <code class="docutils literal notranslate"><span class="pre">Dataset</span></code>’s <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ModalConvertCallback</span></code>: Defines how to convert user’s raw data files (e.g., <code class="docutils literal notranslate"><span class="pre">.mp4</span></code> videos, <code class="docutils literal notranslate"><span class="pre">.jsonl</span></code> action sequences) into the LMDB format used by MineStudio.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DrawFrameCallback</span></code>: Defines how to draw modality-specific information onto video frames during data visualization.</p></li>
</ol>
</section>
<section id="detailed-explanation-of-core-callback-types">
<h2>2. Detailed Explanation of Core Callback Types<a class="headerlink" href="#detailed-explanation-of-core-callback-types" title="Link to this heading">#</a></h2>
<p>The following provides a detailed introduction to these three core callback types and the key methods that need to be implemented.</p>
<section id="modalkernelcallback">
<h3>2.1. <code class="docutils literal notranslate"><span class="pre">ModalKernelCallback</span></code><a class="headerlink" href="#modalkernelcallback" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">ModalKernelCallback</span></code> (defined in <code class="docutils literal notranslate"><span class="pre">minestudio.data.minecraft.callbacks.callback.ModalKernelCallback</span></code>) is used by <code class="docutils literal notranslate"><span class="pre">ModalKernel</span></code> and <code class="docutils literal notranslate"><span class="pre">KernelManager</span></code> during the data loading and processing pipeline. It is responsible for handling single data chunks or sequences of data chunks read from LMDB and transforming them into the format required for model training.</p>
<p><strong>Main Responsibilities:</strong></p>
<ul class="simple">
<li><p>Decode raw byte data read from LMDB.</p></li>
<li><p>Merge multiple data chunks (if necessary).</p></li>
<li><p>Slice data according to a given time window and frame skipping parameters.</p></li>
<li><p>Pad data to meet fixed length requirements.</p></li>
<li><p>Perform data post-processing, such as data augmentation, format conversion, etc.</p></li>
</ul>
<p><strong>Key Methods to Implement/Override:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">__init__(self,</span> <span class="pre">read_bias:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">win_bias:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0)</span></code>:</p>
<ul>
<li><p>Constructor. <code class="docutils literal notranslate"><span class="pre">read_bias</span></code> and <code class="docutils literal notranslate"><span class="pre">win_bias</span></code> are used to adjust the starting position of the window when reading data.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">name(self)</span> <span class="pre">-&gt;</span> <span class="pre">str</span></code> (property):</p>
<ul>
<li><p>Returns the name of the modality handled by this callback (e.g., <code class="docutils literal notranslate"><span class="pre">&quot;image&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;action&quot;</span></code>). This is typically inferred automatically from the class name.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">filter_dataset_paths(self,</span> <span class="pre">dataset_paths:</span> <span class="pre">List[Union[str,</span> <span class="pre">Path]])</span> <span class="pre">-&gt;</span> <span class="pre">List[Path]</span></code>:</p>
<ul>
<li><p>(Optional) Filters the list of dataset paths provided to <code class="docutils literal notranslate"><span class="pre">ModalKernel</span></code>. By default, it looks for subdirectories matching the modality name.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_decode(self,</span> <span class="pre">chunk:</span> <span class="pre">bytes,</span> <span class="pre">**kwargs)</span> <span class="pre">-&gt;</span> <span class="pre">Any</span></code>:</p>
<ul>
<li><p><strong>[Core]</strong> Decodes a single raw byte data chunk <code class="docutils literal notranslate"><span class="pre">chunk</span></code> read from LMDB into its original format (e.g., <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code> for images, <code class="docutils literal notranslate"><span class="pre">dict</span></code> for actions).</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_merge(self,</span> <span class="pre">chunk_list:</span> <span class="pre">List[bytes],</span> <span class="pre">**kwargs)</span> <span class="pre">-&gt;</span> <span class="pre">Union[List,</span> <span class="pre">Dict]</span></code>:</p>
<ul>
<li><p><strong>[Core]</strong> Merges multiple decoded data chunks <code class="docutils literal notranslate"><span class="pre">chunk_list</span></code> into a single data structure. This is crucial for sequential data that spans multiple chunks.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_slice(self,</span> <span class="pre">data:</span> <span class="pre">Union[List,</span> <span class="pre">Dict],</span> <span class="pre">start:</span> <span class="pre">int,</span> <span class="pre">end:</span> <span class="pre">int,</span> <span class="pre">skip_frame:</span> <span class="pre">int,</span> <span class="pre">**kwargs)</span> <span class="pre">-&gt;</span> <span class="pre">Union[List,</span> <span class="pre">Dict]</span></code>:</p>
<ul>
<li><p><strong>[Core]</strong> Extracts a subsequence from the merged data <code class="docutils literal notranslate"><span class="pre">data</span></code> based on <code class="docutils literal notranslate"><span class="pre">start</span></code> (start frame index), <code class="docutils literal notranslate"><span class="pre">end</span></code> (end frame index), and <code class="docutils literal notranslate"><span class="pre">skip_frame</span></code> (frame skip count).</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_pad(self,</span> <span class="pre">data:</span> <span class="pre">Union[List,</span> <span class="pre">Dict],</span> <span class="pre">pad_len:</span> <span class="pre">int,</span> <span class="pre">pad_pos:</span> <span class="pre">Literal[&quot;left&quot;,</span> <span class="pre">&quot;right&quot;],</span> <span class="pre">**kwargs)</span> <span class="pre">-&gt;</span> <span class="pre">Tuple[Union[List,</span> <span class="pre">Dict],</span> <span class="pre">np.ndarray]</span></code>:</p>
<ul>
<li><p><strong>[Core]</strong> If the sliced data length is less than <code class="docutils literal notranslate"><span class="pre">pad_len</span></code>, pads it at the position specified by <code class="docutils literal notranslate"><span class="pre">pad_pos</span></code> (<code class="docutils literal notranslate"><span class="pre">&quot;left&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;right&quot;</span></code>). Also returns a mask indicating which frames are valid and which are padded.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_postprocess(self,</span> <span class="pre">data:</span> <span class="pre">Dict,</span> <span class="pre">**kwargs)</span> <span class="pre">-&gt;</span> <span class="pre">Dict</span></code>:</p>
<ul>
<li><p>(Optional) Performs post-processing on the finally processed data, such as applying data augmentations, converting to PyTorch tensors, etc.</p></li>
</ul>
</li>
</ul>
</section>
<section id="modalconvertcallback">
<h3>2.2. <code class="docutils literal notranslate"><span class="pre">ModalConvertCallback</span></code><a class="headerlink" href="#modalconvertcallback" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">ModalConvertCallback</span></code> (defined in <code class="docutils literal notranslate"><span class="pre">minestudio.data.minecraft.callbacks.callback.ModalConvertCallback</span></code>) is used by <code class="docutils literal notranslate"><span class="pre">ConvertManager</span></code> and <code class="docutils literal notranslate"><span class="pre">ConvertWorker</span></code> during the data preprocessing stage. It is responsible for converting user-provided raw trajectory data (e.g., video files, action logs) into MineStudio’s LMDB database format.</p>
<p><strong>Main Responsibilities:</strong></p>
<ul class="simple">
<li><p>Discover and load raw data files from specified input directories.</p></li>
<li><p>Convert raw data file content into a sequence of byte chunks suitable for storage in LMDB.</p></li>
<li><p>(Optional) Generate frame skip flags for skipping certain frames during conversion.</p></li>
</ul>
<p><strong>Key Methods to Implement/Override:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">__init__(self,</span> <span class="pre">input_dirs:</span> <span class="pre">List[str],</span> <span class="pre">chunk_size:</span> <span class="pre">int)</span></code>:</p>
<ul>
<li><p>Constructor. <code class="docutils literal notranslate"><span class="pre">input_dirs</span></code> is a list of directories containing raw data files, and <code class="docutils literal notranslate"><span class="pre">chunk_size</span></code> defines the number of frames (or other units) contained in each LMDB data chunk.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">load_episodes(self)</span> <span class="pre">-&gt;</span> <span class="pre">Dict[str,</span> <span class="pre">List[Tuple[str,</span> <span class="pre">str]]]</span></code>:</p>
<ul>
<li><p><strong>[Core]</strong> Scans <code class="docutils literal notranslate"><span class="pre">self.input_dirs</span></code>, discovers all raw data files, and organizes them into a dictionary. The dictionary keys are episode IDs, and the values are lists of file paths (or other metadata) associated with that episode.</p></li>
<li><p>The returned structure is typically <code class="docutils literal notranslate"><span class="pre">OrderedDict[eps_id,</span> <span class="pre">List[Tuple[modal_name,</span> <span class="pre">file_path]]]</span></code> or similar, indicating which modality files each episode contains.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_convert(self,</span> <span class="pre">eps_id:</span> <span class="pre">str,</span> <span class="pre">skip_frames:</span> <span class="pre">List[List[bool]],</span> <span class="pre">modal_file_path:</span> <span class="pre">List[Union[str,</span> <span class="pre">Path]])</span> <span class="pre">-&gt;</span> <span class="pre">Tuple[List,</span> <span class="pre">List]</span></code>:</p>
<ul>
<li><p><strong>[Core]</strong> Performs the actual conversion operation for a single episode (<code class="docutils literal notranslate"><span class="pre">eps_id</span></code>) and its corresponding raw file paths (<code class="docutils literal notranslate"><span class="pre">modal_file_path</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">skip_frames</span></code> is an optional list of frame skip flags.</p></li>
<li><p>This method should read the raw files, process their content and split it into multiple data chunks (each corresponding to <code class="docutils literal notranslate"><span class="pre">chunk_size</span></code> frames), and then encode each chunk into a byte string.</p></li>
<li><p>Returns a tuple containing <code class="docutils literal notranslate"><span class="pre">(key_list,</span> <span class="pre">chunk_list)</span></code>. <code class="docutils literal notranslate"><span class="pre">key_list</span></code> are the keys for each chunk (usually frame numbers or timestamps), and <code class="docutils literal notranslate"><span class="pre">chunk_list</span></code> are the corresponding encoded byte data chunks.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">gen_frame_skip_flags(self,</span> <span class="pre">file_name:</span> <span class="pre">str)</span> <span class="pre">-&gt;</span> <span class="pre">List[bool]</span></code>:</p>
<ul>
<li><p>(Optional) Generates a boolean list for a given raw data file, indicating which frames should be skipped during conversion. Can return <code class="docutils literal notranslate"><span class="pre">None</span></code> or a list of all <code class="docutils literal notranslate"><span class="pre">False</span></code> if no frames need to be skipped.</p></li>
</ul>
</li>
</ul>
</section>
<section id="drawframecallback">
<h3>2.3. <code class="docutils literal notranslate"><span class="pre">DrawFrameCallback</span></code><a class="headerlink" href="#drawframecallback" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">DrawFrameCallback</span></code> (defined in <code class="docutils literal notranslate"><span class="pre">minestudio.data.minecraft.callbacks.callback.DrawFrameCallback</span></code>) is used during data visualization to draw modality-specific information onto video frames. For example, displaying action data as text or overlaying segmentation masks on images.</p>
<p><strong>Main Responsibilities:</strong></p>
<ul class="simple">
<li><p>Receive a batch of video frames and corresponding modality data.</p></li>
<li><p>Draw the modality data onto the corresponding video frames in graphical or textual form.</p></li>
</ul>
<p><strong>Key Methods to Implement/Override:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">draw_frames(self,</span> <span class="pre">frames:</span> <span class="pre">Union[np.ndarray,</span> <span class="pre">List],</span> <span class="pre">infos:</span> <span class="pre">Dict,</span> <span class="pre">sample_idx:</span> <span class="pre">int,</span> <span class="pre">**kwargs)</span> <span class="pre">-&gt;</span> <span class="pre">np.ndarray</span></code>:</p>
<ul>
<li><p><strong>[Core]</strong> This method receives a batch of video frames <code class="docutils literal notranslate"><span class="pre">frames</span></code> (usually a NumPy array of shape <code class="docutils literal notranslate"><span class="pre">(B,</span> <span class="pre">T,</span> <span class="pre">H,</span> <span class="pre">W,</span> <span class="pre">C)</span></code> or <code class="docutils literal notranslate"><span class="pre">(T,</span> <span class="pre">H,</span> <span class="pre">W,</span> <span class="pre">C)</span></code>, where B is batch size, T is sequence length) and a dictionary <code class="docutils literal notranslate"><span class="pre">infos</span></code> containing the corresponding modality data. <code class="docutils literal notranslate"><span class="pre">sample_idx</span></code> indicates the current sample in the batch.</p></li>
<li><p>The keys of the <code class="docutils literal notranslate"><span class="pre">infos</span></code> dictionary are modality names (e.g., <code class="docutils literal notranslate"><span class="pre">&quot;action&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;segmentation&quot;</span></code>), and the values are the data for that modality.</p></li>
<li><p>This method needs to iterate through the frames and corresponding <code class="docutils literal notranslate"><span class="pre">infos</span></code>, drawing the information onto the frames (e.g., using OpenCV drawing functions).</p></li>
<li><p>Returns the video frames with the information drawn on them (NumPy array).</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="examples-of-built-in-callbacks">
<h2>3. Examples of Built-in Callbacks<a class="headerlink" href="#examples-of-built-in-callbacks" title="Link to this heading">#</a></h2>
<p>MineStudio provides a series of built-in callback implementations for common Minecraft data modalities. These implementations are located in the <code class="docutils literal notranslate"><span class="pre">minestudio.data.minecraft.callbacks</span></code> directory.</p>
<section id="image-callbacks">
<h3>3.1. Image Callbacks<a class="headerlink" href="#image-callbacks" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">ImageKernelCallback</span></code></strong> (in <code class="docutils literal notranslate"><span class="pre">image.py</span></code>):</p>
<ul>
<li><p><strong>Purpose</strong>: Processes image data loaded from LMDB.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_decode</span></code>: Decodes byte strings into NumPy image arrays.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_merge</span></code>: Concatenates a list of image chunks into a video sequence (NumPy array <code class="docutils literal notranslate"><span class="pre">(T,</span> <span class="pre">H,</span> <span class="pre">W,</span> <span class="pre">C)</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_slice</span></code>: Extracts a specified range of frames.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_pad</span></code>: Pads the frame sequence.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_postprocess</span></code>: Optionally applies <code class="docutils literal notranslate"><span class="pre">VideoAugmentation</span></code> for data augmentation and converts images to PyTorch tensors.</p></li>
<li><p><strong>Parameters</strong>: <code class="docutils literal notranslate"><span class="pre">frame_width</span></code>, <code class="docutils literal notranslate"><span class="pre">frame_height</span></code>, <code class="docutils literal notranslate"><span class="pre">enable_video_aug</span></code> (whether to enable video augmentation), <code class="docutils literal notranslate"><span class="pre">image_format</span></code> (e.g., “CHW”, “HWC”).</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">ImageConvertCallback</span></code></strong> (in <code class="docutils literal notranslate"><span class="pre">image.py</span></code>):</p>
<ul>
<li><p><strong>Purpose</strong>: Converts raw video files (e.g., <code class="docutils literal notranslate"><span class="pre">.mp4</span></code>) or image sequence directories to LMDB format.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">load_episodes</span></code>: Scans input directories for video files.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_convert</span></code>: Uses OpenCV to read video frames, encoding every <code class="docutils literal notranslate"><span class="pre">chunk_size</span></code> frames into a JPEG byte string (or other format) as one LMDB data chunk.</p></li>
<li><p><strong>Parameters</strong>: <code class="docutils literal notranslate"><span class="pre">input_dirs</span></code>, <code class="docutils literal notranslate"><span class="pre">chunk_size</span></code>, <code class="docutils literal notranslate"><span class="pre">thread_pool</span></code> (number of threads for parallel video encoding).</p></li>
</ul>
</li>
</ul>
</section>
<section id="action-callbacks">
<h3>3.2. Action Callbacks<a class="headerlink" href="#action-callbacks" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">ActionKernelCallback</span></code></strong> (in <code class="docutils literal notranslate"><span class="pre">action.py</span></code>):</p>
<ul>
<li><p><strong>Purpose</strong>: Processes action data (usually a sequence of dictionaries) loaded from LMDB.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_decode</span></code>: Decodes JSON-encoded byte strings into action dictionaries.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_merge</span></code>: Merges a list of action dictionaries.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_slice</span></code>: Extracts a specified range of actions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_pad</span></code>: Pads the action sequence (usually with zero actions or the last valid action).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_postprocess</span></code>: Optionally includes the previous frame’s action (<code class="docutils literal notranslate"><span class="pre">enable_prev_action</span></code>).</p></li>
<li><p><strong>Parameters</strong>: <code class="docutils literal notranslate"><span class="pre">enable_prev_action</span></code>, <code class="docutils literal notranslate"><span class="pre">prev_action_pad_val</span></code>, <code class="docutils literal notranslate"><span class="pre">read_bias</span></code>, <code class="docutils literal notranslate"><span class="pre">win_bias</span></code>.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">VectorActionKernelCallback</span></code></strong> (in <code class="docutils literal notranslate"><span class="pre">action.py</span></code>, inherits from <code class="docutils literal notranslate"><span class="pre">ActionKernelCallback</span></code>):</p>
<ul>
<li><p><strong>Purpose</strong>: Specifically handles vectorized action representations.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_postprocess</span></code>: Builds upon <code class="docutils literal notranslate"><span class="pre">ActionKernelCallback</span></code> to convert dictionary-form actions into fixed-dimension vectors, or vice-versa.</p></li>
<li><p>Provides <code class="docutils literal notranslate"><span class="pre">vector_to_action</span></code> and <code class="docutils literal notranslate"><span class="pre">action_to_vector</span></code> methods.</p></li>
<li><p><strong>Parameters</strong>: <code class="docutils literal notranslate"><span class="pre">action_chunk_size</span></code> (similar to <code class="docutils literal notranslate"><span class="pre">chunk_size</span></code>, but specific to context length for action vectorization), <code class="docutils literal notranslate"><span class="pre">return_type</span></code> (“vector” or “dict”).</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">ActionDrawFrameCallback</span></code></strong> (in <code class="docutils literal notranslate"><span class="pre">action.py</span></code>):</p>
<ul>
<li><p><strong>Purpose</strong>: Draws textual representations of action information onto video frames.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">draw_frames</span></code>: Iterates through action data, formats action key-value pairs for each timestep into strings, and draws them onto frames at specified positions using OpenCV’s <code class="docutils literal notranslate"><span class="pre">putText</span></code>.</p></li>
<li><p><strong>Parameters</strong>: <code class="docutils literal notranslate"><span class="pre">start_point</span></code> (starting coordinates for text drawing).</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">ActionConvertCallback</span></code></strong> (in <code class="docutils literal notranslate"><span class="pre">action.py</span></code>):</p>
<ul>
<li><p><strong>Purpose</strong>: Converts raw action files (typically <code class="docutils literal notranslate"><span class="pre">.jsonl</span></code> files, where each line is a JSON object representing one frame’s actions) to LMDB.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">load_episodes</span></code>: Scans input directories for <code class="docutils literal notranslate"><span class="pre">.jsonl</span></code> files.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_convert</span></code>: Reads <code class="docutils literal notranslate"><span class="pre">.jsonl</span></code> files, and every <code class="docutils literal notranslate"><span class="pre">chunk_size</span></code> actions are JSON-encoded and stored as one LMDB data chunk.</p></li>
<li><p><strong>Parameters</strong>: <code class="docutils literal notranslate"><span class="pre">input_dirs</span></code>, <code class="docutils literal notranslate"><span class="pre">chunk_size</span></code>, <code class="docutils literal notranslate"><span class="pre">action_transformer_kwargs</span></code> (parameters for initializing <code class="docutils literal notranslate"><span class="pre">ActionTransformer</span></code>, allowing action transformation and filtering).</p></li>
</ul>
</li>
</ul>
</section>
<section id="metainfo-callbacks">
<h3>3.3. MetaInfo Callbacks<a class="headerlink" href="#metainfo-callbacks" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">MetaInfoKernelCallback</span></code></strong> (in <code class="docutils literal notranslate"><span class="pre">meta_info.py</span></code>):</p>
<ul>
<li><p><strong>Purpose</strong>: Processes game metadata, such as player position, health, time, etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_decode</span></code>: Decodes JSON-encoded byte strings into metainfo dictionaries.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_merge</span></code>, <code class="docutils literal notranslate"><span class="pre">do_slice</span></code>, <code class="docutils literal notranslate"><span class="pre">do_pad</span></code>: Similar to <code class="docutils literal notranslate"><span class="pre">ActionKernelCallback</span></code> for handling sequences of dictionaries.</p></li>
<li><p><strong>Parameters</strong>: No special constructor parameters, relies on the base class.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">MetaInfoDrawFrameCallback</span></code></strong> (in <code class="docutils literal notranslate"><span class="pre">meta_info.py</span></code>):</p>
<ul>
<li><p><strong>Purpose</strong>: Draws metainfo onto video frames.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">draw_frames</span></code>: Formats specific key-value pairs from the metainfo dictionary and draws them onto frames.</p></li>
<li><p><strong>Parameters</strong>: <code class="docutils literal notranslate"><span class="pre">start_point</span></code>.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">MetaInfoConvertCallback</span></code></strong> (in <code class="docutils literal notranslate"><span class="pre">meta_info.py</span></code>):</p>
<ul>
<li><p><strong>Purpose</strong>: Converts raw metainfo files (typically <code class="docutils literal notranslate"><span class="pre">.jsonl</span></code> or <code class="docutils literal notranslate"><span class="pre">.pkl</span></code> files containing metainfo dictionaries) to LMDB.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">load_episodes</span></code>: Scans input directories for metainfo files.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_convert</span></code>: Reads files, and every <code class="docutils literal notranslate"><span class="pre">chunk_size</span></code> frames of metainfo are JSON-encoded and stored as one LMDB data chunk.</p></li>
<li><p><strong>Parameters</strong>: <code class="docutils literal notranslate"><span class="pre">input_dirs</span></code>, <code class="docutils literal notranslate"><span class="pre">chunk_size</span></code>.</p></li>
</ul>
</li>
</ul>
</section>
<section id="segmentation-callbacks">
<h3>3.4. Segmentation Callbacks<a class="headerlink" href="#segmentation-callbacks" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">SegmentationKernelCallback</span></code></strong> (in <code class="docutils literal notranslate"><span class="pre">segmentation.py</span></code>):</p>
<ul>
<li><p><strong>Purpose</strong>: Processes image segmentation mask data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_decode</span></code>: Decodes byte strings (possibly RLE-encoded masks or other compressed formats) into segmentation masks (NumPy arrays).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_merge</span></code>, <code class="docutils literal notranslate"><span class="pre">do_slice</span></code>, <code class="docutils literal notranslate"><span class="pre">do_pad</span></code>: Performs corresponding processing on sequences of segmentation masks.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_postprocess</span></code>: May include resizing masks, remapping class IDs, etc.</p></li>
<li><p><strong>Parameters</strong>: <code class="docutils literal notranslate"><span class="pre">frame_width</span></code>, <code class="docutils literal notranslate"><span class="pre">frame_height</span></code> (target frame dimensions), <code class="docutils literal notranslate"><span class="pre">seg_re_map</span></code> (class ID remapping dictionary).</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">SegmentationDrawFrameCallback</span></code></strong> (in <code class="docutils literal notranslate"><span class="pre">segmentation.py</span></code>):</p>
<ul>
<li><p><strong>Purpose</strong>: Overlays segmentation masks or related information (like target points) onto video frames.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">draw_frames</span></code>: Can draw segmentation masks with different colors or highlight specific objects.</p></li>
<li><p><strong>Parameters</strong>: <code class="docutils literal notranslate"><span class="pre">start_point</span></code>, <code class="docutils literal notranslate"><span class="pre">draw_point</span></code>, <code class="docutils literal notranslate"><span class="pre">draw_mask</span></code>, <code class="docutils literal notranslate"><span class="pre">draw_event</span></code>, <code class="docutils literal notranslate"><span class="pre">draw_frame_id</span></code>, <code class="docutils literal notranslate"><span class="pre">draw_frame_range</span></code>, and a color list <code class="docutils literal notranslate"><span class="pre">COLORS</span></code>.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">SegmentationConvertCallback</span></code></strong> (in <code class="docutils literal notranslate"><span class="pre">segmentation.py</span></code>):</p>
<ul>
<li><p><strong>Purpose</strong>: Converts raw segmentation data files (e.g., <code class="docutils literal notranslate"><span class="pre">.pkl</span></code> files containing RLE-encoded masks) to LMDB.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">load_episodes</span></code>: Scans input directories for segmentation data files.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">do_convert</span></code>: Reads raw segmentation data, encodes it (if necessary), and stores every <code class="docutils literal notranslate"><span class="pre">chunk_size</span></code> frames of segmentation data as one LMDB data chunk.</p></li>
<li><p><strong>Parameters</strong>: <code class="docutils literal notranslate"><span class="pre">input_dirs</span></code>, <code class="docutils literal notranslate"><span class="pre">chunk_size</span></code>.</p></li>
</ul>
</li>
</ul>
<p>Through these callbacks, MineStudio provides a powerful and flexible framework for handling various Minecraft data. Users can modify these built-in callbacks or create their own callback implementations for entirely new data types.</p>
</section>
</section>
</section>

<div class="section ablog__blog_comments">
   
</div>

                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="convertion.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Data Conversion</p>
      </div>
    </a>
    <a class="right-next"
       href="../models/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Models</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#design-philosophy">1. Design Philosophy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#detailed-explanation-of-core-callback-types">2. Detailed Explanation of Core Callback Types</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modalkernelcallback">2.1. <code class="docutils literal notranslate"><span class="pre">ModalKernelCallback</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modalconvertcallback">2.2. <code class="docutils literal notranslate"><span class="pre">ModalConvertCallback</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#drawframecallback">2.3. <code class="docutils literal notranslate"><span class="pre">DrawFrameCallback</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples-of-built-in-callbacks">3. Examples of Built-in Callbacks</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#image-callbacks">3.1. Image Callbacks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#action-callbacks">3.2. Action Callbacks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metainfo-callbacks">3.3. MetaInfo Callbacks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#segmentation-callbacks">3.4. Segmentation Callbacks</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/data/callbacks.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, The CraftJarvis Team.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>